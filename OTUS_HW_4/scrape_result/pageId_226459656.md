[Рутокен Логон для Linux. Версия 1.0.0. Руководство администратора](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656)

-







Created by [Кириллова Дарья](https://dev.rutoken.ru/display/~kirillova), last modified on [Dec 11, 2025](https://dev.rutoken.ru/pages/diffpagesbyversion.action?pageId=226459656&selectedPageVersions=7&selectedPageVersions=8 "Show changes")

- 1 [Общая информация](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%9E%D0%B1%D1%89%D0%B0%D1%8F%D0%B8%D0%BD%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%86%D0%B8%D1%8F)
- 2 [О программном комплексе](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%9E%D0%BF%D1%80%D0%BE%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D0%BD%D0%BE%D0%BC%D0%BA%D0%BE%D0%BC%D0%BF%D0%BB%D0%B5%D0%BA%D1%81%D0%B5)
  - 2.1 [Назначение](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%9D%D0%B0%D0%B7%D0%BD%D0%B0%D1%87%D0%B5%D0%BD%D0%B8%D0%B5)
  - 2.2 [Состав](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%A1%D0%BE%D1%81%D1%82%D0%B0%D0%B2)
  - 2.3 [Описание компонентов](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%9E%D0%BF%D0%B8%D1%81%D0%B0%D0%BD%D0%B8%D0%B5%D0%BA%D0%BE%D0%BC%D0%BF%D0%BE%D0%BD%D0%B5%D0%BD%D1%82%D0%BE%D0%B2)
  - 2.4 [Описание работы](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%9E%D0%BF%D0%B8%D1%81%D0%B0%D0%BD%D0%B8%D0%B5%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D1%8B)
- 3 [Поддерживаемое окружение](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%9F%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%B8%D0%B2%D0%B0%D0%B5%D0%BC%D0%BE%D0%B5%D0%BE%D0%BA%D1%80%D1%83%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5)
  - 3.1 [Поддерживаемые устройства](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%9F%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%B8%D0%B2%D0%B0%D0%B5%D0%BC%D1%8B%D0%B5%D1%83%D1%81%D1%82%D1%80%D0%BE%D0%B9%D1%81%D1%82%D0%B2%D0%B0)
  - 3.2 [Поддерживаемые платформы](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%9F%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%B8%D0%B2%D0%B0%D0%B5%D0%BC%D1%8B%D0%B5%D0%BF%D0%BB%D0%B0%D1%82%D1%84%D0%BE%D1%80%D0%BC%D1%8B)
  - 3.3 [Поддерживаемые ОС](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%9F%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%B8%D0%B2%D0%B0%D0%B5%D0%BC%D1%8B%D0%B5%D0%9E%D0%A1)
  - 3.4 [Поддерживаемые графические окружения](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%9F%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%B8%D0%B2%D0%B0%D0%B5%D0%BC%D1%8B%D0%B5%D0%B3%D1%80%D0%B0%D1%84%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%B5%D0%BE%D0%BA%D1%80%D1%83%D0%B6%D0%B5%D0%BD%D0%B8%D1%8F)
  - 3.5 [Поддерживаемые контроллеры домена](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%9F%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%B8%D0%B2%D0%B0%D0%B5%D0%BC%D1%8B%D0%B5%D0%BA%D0%BE%D0%BD%D1%82%D1%80%D0%BE%D0%BB%D0%BB%D0%B5%D1%80%D1%8B%D0%B4%D0%BE%D0%BC%D0%B5%D0%BD%D0%B0)
  - 3.6 [Необходимые библиотеки и зависимости](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%9D%D0%B5%D0%BE%D0%B1%D1%85%D0%BE%D0%B4%D0%B8%D0%BC%D1%8B%D0%B5%D0%B1%D0%B8%D0%B1%D0%BB%D0%B8%D0%BE%D1%82%D0%B5%D0%BA%D0%B8%D0%B8%D0%B7%D0%B0%D0%B2%D0%B8%D1%81%D0%B8%D0%BC%D0%BE%D1%81%D1%82%D0%B8)
- 4 [Лицензирование продукта](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%9B%D0%B8%D1%86%D0%B5%D0%BD%D0%B7%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5%D0%BF%D1%80%D0%BE%D0%B4%D1%83%D0%BA%D1%82%D0%B0)
  - 4.1 [Общая информация](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%9E%D0%B1%D1%89%D0%B0%D1%8F%D0%B8%D0%BD%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%86%D0%B8%D1%8F.1)
  - 4.2 [Установка сервера лицензирования](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0%D1%81%D0%B5%D1%80%D0%B2%D0%B5%D1%80%D0%B0%D0%BB%D0%B8%D1%86%D0%B5%D0%BD%D0%B7%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F)
  - 4.3 [Удаление сервера лицензирования](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%A3%D0%B4%D0%B0%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5%D1%81%D0%B5%D1%80%D0%B2%D0%B5%D1%80%D0%B0%D0%BB%D0%B8%D1%86%D0%B5%D0%BD%D0%B7%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F)
  - 4.4 [Запуск Мастера лицензий Guardant](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%97%D0%B0%D0%BF%D1%83%D1%81%D0%BA%D0%9C%D0%B0%D1%81%D1%82%D0%B5%D1%80%D0%B0%D0%BB%D0%B8%D1%86%D0%B5%D0%BD%D0%B7%D0%B8%D0%B9Guardant)
  - 4.5 [Активация лицензии](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%90%D0%BA%D1%82%D0%B8%D0%B2%D0%B0%D1%86%D0%B8%D1%8F%D0%BB%D0%B8%D1%86%D0%B5%D0%BD%D0%B7%D0%B8%D0%B8)
- 5 [Настройка ПК для работы c rtlogon](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%9D%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0%D0%9F%D0%9A%D0%B4%D0%BB%D1%8F%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D1%8Bcrtlogon)
  - 5.1 [Настройка Network manager для экрана приветствия ОС Astra Linux](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%9D%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0Networkmanager%D0%B4%D0%BB%D1%8F%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%D0%BF%D1%80%D0%B8%D0%B2%D0%B5%D1%82%D1%81%D1%82%D0%B2%D0%B8%D1%8F%D0%9E%D0%A1AstraLinux)
  - 5.2 [Ввод ПК в домен](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%92%D0%B2%D0%BE%D0%B4%D0%9F%D0%9A%D0%B2%D0%B4%D0%BE%D0%BC%D0%B5%D0%BD)
    - 5.2.1 [Active Directory](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-ActiveDirectory)
    - 5.2.2 [FreeIPA](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-FreeIPA)
    - 5.2.3 [ALDPro](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-ALDPro)
    - 5.2.4 [Samba DC](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-SambaDC)
  - 5.3 [Проверка ввода ПК в домен](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%9F%D1%80%D0%BE%D0%B2%D0%B5%D1%80%D0%BA%D0%B0%D0%B2%D0%B2%D0%BE%D0%B4%D0%B0%D0%9F%D0%9A%D0%B2%D0%B4%D0%BE%D0%BC%D0%B5%D0%BD)
  - 5.4 [Загрузка корневого сертификата или сертификатов цепочки доверия УЦ на ПК](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%97%D0%B0%D0%B3%D1%80%D1%83%D0%B7%D0%BA%D0%B0%D0%BA%D0%BE%D1%80%D0%BD%D0%B5%D0%B2%D0%BE%D0%B3%D0%BE%D1%81%D0%B5%D1%80%D1%82%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%82%D0%B0%D0%B8%D0%BB%D0%B8%D1%81%D0%B5%D1%80%D1%82%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%82%D0%BE%D0%B2%D1%86%D0%B5%D0%BF%D0%BE%D1%87%D0%BA%D0%B8%D0%B4%D0%BE%D0%B2%D0%B5%D1%80%D0%B8%D1%8F%D0%A3%D0%A6%D0%BD%D0%B0%D0%9F%D0%9A)
    - 5.4.1 [FreeIPA и ALDPro](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-FreeIPA%D0%B8ALDPro)
      - 5.4.1.1 [Корневой сертификат](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%9A%D0%BE%D1%80%D0%BD%D0%B5%D0%B2%D0%BE%D0%B9%D1%81%D0%B5%D1%80%D1%82%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%82)
      - 5.4.1.2 [Сертификаты цепочки доверия УЦ](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%A1%D0%B5%D1%80%D1%82%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%82%D1%8B%D1%86%D0%B5%D0%BF%D0%BE%D1%87%D0%BA%D0%B8%D0%B4%D0%BE%D0%B2%D0%B5%D1%80%D0%B8%D1%8F%D0%A3%D0%A6)
    - 5.4.2 [Active Directory](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-ActiveDirectory.1)
    - 5.4.3 [Samba DC](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-SambaDC.1)
- 6 [Установка rtlogon](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0rtlogon)
- 7 [Установка библиотеки libjcPKCS11-2.so](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0%D0%B1%D0%B8%D0%B1%D0%BB%D0%B8%D0%BE%D1%82%D0%B5%D0%BA%D0%B8libjcPKCS11-2.so)
- 8 [Команды и общие параметры rtlogon](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%9A%D0%BE%D0%BC%D0%B0%D0%BD%D0%B4%D1%8B%D0%B8%D0%BE%D0%B1%D1%89%D0%B8%D0%B5%D0%BF%D0%B0%D1%80%D0%B0%D0%BC%D0%B5%D1%82%D1%80%D1%8Brtlogon)
- 9 [Обновление rtlogon](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%9E%D0%B1%D0%BD%D0%BE%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5rtlogon)
- 10 [Удаление rtlogon](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%A3%D0%B4%D0%B0%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5rtlogon)
- 11 [Настройка ОС для работы с 2ФА](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%9D%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0%D0%9E%D0%A1%D0%B4%D0%BB%D1%8F%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D1%8B%D1%812%D0%A4%D0%90)
- 12 [Реконфигурация ОС для работы с 2ФА](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%A0%D0%B5%D0%BA%D0%BE%D0%BD%D1%84%D0%B8%D0%B3%D1%83%D1%80%D0%B0%D1%86%D0%B8%D1%8F%D0%9E%D0%A1%D0%B4%D0%BB%D1%8F%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D1%8B%D1%812%D0%A4%D0%90)
- 13 [Отключение настроек ОС для работы с 2ФА](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%9E%D1%82%D0%BA%D0%BB%D1%8E%D1%87%D0%B5%D0%BD%D0%B8%D0%B5%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B5%D0%BA%D0%9E%D0%A1%D0%B4%D0%BB%D1%8F%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D1%8B%D1%812%D0%A4%D0%90)
- 14 [Проверка сертификатов пользователей на статус "отозванный"](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%9F%D1%80%D0%BE%D0%B2%D0%B5%D1%80%D0%BA%D0%B0%D1%81%D0%B5%D1%80%D1%82%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%82%D0%BE%D0%B2%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D1%82%D0%B5%D0%BB%D0%B5%D0%B9%D0%BD%D0%B0%D1%81%D1%82%D0%B0%D1%82%D1%83%D1%81%22%D0%BE%D1%82%D0%BE%D0%B7%D0%B2%D0%B0%D0%BD%D0%BD%D1%8B%D0%B9%22)
  - 14.1 [CRL](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-CRL)
  - 14.2 [OCSP](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-OCSP)
- 15 [Настройка 2ФА](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%9D%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B02%D0%A4%D0%90)
- 16 [Проверка настройки 2ФА](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%9F%D1%80%D0%BE%D0%B2%D0%B5%D1%80%D0%BA%D0%B0%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B82%D0%A4%D0%90)
- 17 [Изменение настроек 2ФА](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%98%D0%B7%D0%BC%D0%B5%D0%BD%D0%B5%D0%BD%D0%B8%D0%B5%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B5%D0%BA2%D0%A4%D0%90)
- 18 [Удаление 2ФА](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%A3%D0%B4%D0%B0%D0%BB%D0%B5%D0%BD%D0%B8%D0%B52%D0%A4%D0%90)
- 19 [Кеширование УЗ](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%9A%D0%B5%D1%88%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5%D0%A3%D0%97)
- 20 [Создание запроса на получение сертификата, генерация самоподписанного сертификата](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%A1%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5%D0%B7%D0%B0%D0%BF%D1%80%D0%BE%D1%81%D0%B0%D0%BD%D0%B0%D0%BF%D0%BE%D0%BB%D1%83%D1%87%D0%B5%D0%BD%D0%B8%D0%B5%D1%81%D0%B5%D1%80%D1%82%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%82%D0%B0,%D0%B3%D0%B5%D0%BD%D0%B5%D1%80%D0%B0%D1%86%D0%B8%D1%8F%D1%81%D0%B0%D0%BC%D0%BE%D0%BF%D0%BE%D0%B4%D0%BF%D0%B8%D1%81%D0%B0%D0%BD%D0%BD%D0%BE%D0%B3%D0%BE%D1%81%D0%B5%D1%80%D1%82%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%82%D0%B0)
- 21 [Получение сертификата УЗ от УЦ](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%9F%D0%BE%D0%BB%D1%83%D1%87%D0%B5%D0%BD%D0%B8%D0%B5%D1%81%D0%B5%D1%80%D1%82%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%82%D0%B0%D0%A3%D0%97%D0%BE%D1%82%D0%A3%D0%A6)
  - 21.1 [FreeIPA и ALDPro](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-FreeIPA%D0%B8ALDPro.1)
  - 21.2 [Active Directory](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-ActiveDirectory.2)
  - 21.3 [Samba DC](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-SambaDC.2)
- 22 [Смена PIN-кода токена](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%A1%D0%BC%D0%B5%D0%BD%D0%B0PIN-%D0%BA%D0%BE%D0%B4%D0%B0%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%B0)
- 23 [Разблокировка PIN-кода на экране приветствия или блокировки](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%A0%D0%B0%D0%B7%D0%B1%D0%BB%D0%BE%D0%BA%D0%B8%D1%80%D0%BE%D0%B2%D0%BA%D0%B0PIN-%D0%BA%D0%BE%D0%B4%D0%B0%D0%BD%D0%B0%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B5%D0%BF%D1%80%D0%B8%D0%B2%D0%B5%D1%82%D1%81%D1%82%D0%B2%D0%B8%D1%8F%D0%B8%D0%BB%D0%B8%D0%B1%D0%BB%D0%BE%D0%BA%D0%B8%D1%80%D0%BE%D0%B2%D0%BA%D0%B8)
- 24 [Запрос информации о конфигурации rtlogon и параметрах локальной 2ФА](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%97%D0%B0%D0%BF%D1%80%D0%BE%D1%81%D0%B8%D0%BD%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%86%D0%B8%D0%B8%D0%BE%D0%BA%D0%BE%D0%BD%D1%84%D0%B8%D0%B3%D1%83%D1%80%D0%B0%D1%86%D0%B8%D0%B8rtlogon%D0%B8%D0%BF%D0%B0%D1%80%D0%B0%D0%BC%D0%B5%D1%82%D1%80%D0%B0%D1%85%D0%BB%D0%BE%D0%BA%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D0%B92%D0%A4%D0%90)
- 25 [Логирование работы rtlogon](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%9B%D0%BE%D0%B3%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D1%8Brtlogon)
- 26 [Экспорт конфигурационных файлов, лог-файлов и файла с параметрами локальной 2ФА](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%AD%D0%BA%D1%81%D0%BF%D0%BE%D1%80%D1%82%D0%BA%D0%BE%D0%BD%D1%84%D0%B8%D0%B3%D1%83%D1%80%D0%B0%D1%86%D0%B8%D0%BE%D0%BD%D0%BD%D1%8B%D1%85%D1%84%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2,%D0%BB%D0%BE%D0%B3-%D1%84%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2%D0%B8%D1%84%D0%B0%D0%B9%D0%BB%D0%B0%D1%81%D0%BF%D0%B0%D1%80%D0%B0%D0%BC%D0%B5%D1%82%D1%80%D0%B0%D0%BC%D0%B8%D0%BB%D0%BE%D0%BA%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D0%B92%D0%A4%D0%90)
- 27 [Приложение 1\. Ошибки](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%9F%D1%80%D0%B8%D0%BB%D0%BE%D0%B6%D0%B5%D0%BD%D0%B8%D0%B51.%D0%9E%D1%88%D0%B8%D0%B1%D0%BA%D0%B8)
  - 27.1 [Ошибки, выводимые в GUI](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%9E%D1%88%D0%B8%D0%B1%D0%BA%D0%B8,%D0%B2%D1%8B%D0%B2%D0%BE%D0%B4%D0%B8%D0%BC%D1%8B%D0%B5%D0%B2GUI)
  - 27.2 [Ошибки, выводимые в терминале](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%9E%D1%88%D0%B8%D0%B1%D0%BA%D0%B8,%D0%B2%D1%8B%D0%B2%D0%BE%D0%B4%D0%B8%D0%BC%D1%8B%D0%B5%D0%B2%D1%82%D0%B5%D1%80%D0%BC%D0%B8%D0%BD%D0%B0%D0%BB%D0%B5)

## Общая информация

Термины, определения и аббревиатуры

**Двухфакторная аутентификация (2ФА)**– тип аутентификации, при которой требуется предъявить 2 фактора. Чаще всего для 2ФА используется фактор владения ключевым носителем (например, токен или смарт-карта) и фактор знания (например, PIN-код от устройства).

**Однофакторная аутентификация (1ФА)** – тип аутентификации, при которой требуется предъявить 1 фактор. Чаще всего для 1ФА используется фактор знания (пароль).

**Ключевая пара** – набор из открытого и закрытого ключей электронной подписи, однозначно привязанных друг к другу.

**Сложный пароль** – пароль размером 72 произвольных символа, хранящийся на ключевом носителе. Используется для 2ФА.

**Учетная запись (УЗ)** – совокупность данных, однозначно определяющих пользователя ПК.

**Доменная УЗ** – учетная запись, зарегистрированная в доменной службе. Используется для управления доступом к сетевым ресурсам в пределах домена, таким как ПК, серверы, файлы и принтеры.

**Локальная УЗ** – учетная запись, которая создается и хранится на конкретном ПК и используется для доступа к его ресурсам. В отличие от доменной УЗ, локальная не предоставляет доступ к сетевым ресурсам или другим ПК в сети без дополнительной настройки.

**Удостоверяющий центр (УЦ)** – доверенный орган, который имеет право выпускать сертификаты электронной подписи юридическим и физическим лицам. В рамках "Рутокен Логон для Linux" выпускает сертификаты УЗ для настройки одного из типов доменной 2ФА.

**Сертификат** – электронный документ, который подтверждает связь электронной подписи с ее владельцем. Сертификат содержит сведения о его владельце, открытый ключ, информацию о сроке действия сертификата, информацию о выдавшем электронную подпись удостоверяющем центре, серийный номер сертификата и иные сведения.

**Самоподписанный сертификат** – сертификат, генерируемый и подписываемый самой УЗ, без участия УЦ.

**CRL** **(Certificate Revocation List)** – список отозванных сертификатов, публикуемый центром сертификации (CA) для указания, какие сертификаты были аннулированы до истечения срока их действия. Этот список используется для проверки действительности сертификатов и обеспечения безопасности.

**OCSP (Online Certificate Status Protocol)**– протокол, используемый для проверки статуса отзыва цифровых сертификатов в режиме реального времени.

**Экран приветствия** или **Greeter** – экран входа в операционную систему.

**Экран блокировки** или **Lock Screen** – экран блокировки текущей пользовательской сессии с полями для ввода данных УЗ.

**Лицензия** – набор условий, в рамках которых пользователю разрешено использовать защищенное ПО.

**Cервер лицензирования** – многофункциональный сервис, который используется как инструмент для контроля за количеством подключений к сетевым лицензиям, а также для открепления лицензий и использования их на компьютерах пользователей, находящихся вне сети.

**Мастер лицензий Guardant** – утилита, предназначенная для активации, переноса и обновления программных лицензий.

**КД** – контроллер домена.

**ОС** – операционная система.

**ПК** – персональный компьютер.

Настоящее руководство администратора предназначено для сотрудников, осуществляющих системное администрирование программного комплекса "Рутокен Логон для Linux" для локальных и доменных УЗ.

Руководство определяет порядок действий при подготовке к установке, удалению и настройке программного комплекса "Рутокен Логон для Linux".

Сотрудники, осуществляющие установку, настройку и обслуживание программного комплекса "Рутокен Логон для Linux", должны обладать следующими навыками:

- знание и опыт работы с операционными системами семейства Linux на уровне администратора;
- знание и опыт администрирования компьютерных сетей;
- знание и опыт установки и настройки контроллеров домена.

## О программном комплексе

### Назначение

**Рутокен Логон для Linux** (далее по тексту – rtlogon) – это программный комплекс, предназначенный для настройки, управления и использования схемы двухфакторной аутентификации пользователей в ОС семейства Linux. В качестве первого фактора аутентификации используется наличие подключенного к ПК ключевого носителя, в качестве второго – секрет, хранящийся на ключевом носителе, доступ к которому предоставляется только после предъявления верного PIN-кода.

В качестве секрета может использоваться:

- сложный пароль;
- закрытый ключ.

rtlogon поддерживает следующие типы аутентификации:

- по количеству используемых факторов:
  - 2ФА:
    - по наличию подключенного к ПК ключевого носителя и ключевой паре – 2ФА по сертификату;
    - по наличию подключенного к ПК ключевого носителя и сложному паролю – 2ФА по сложному паролю.
  - 1ФА по логину и паролю УЗ (настраивается вне rtlogon).
- по типу УЗ, для которой настраивается аутентификация:
  - локальная;
  - доменная.

### Состав

rtlogon состоит из следующих компонентов:

- rtlogon-cli;
- rtlogon\_event-monitor;
- pam\_rtlogon.so;
- GUI:
  - экран приветствия (Greeter):
    - libfly-dmgreet\_rtlogon.so;
    - lightdm-rtlogon-greeter.
  - экран блокировки (Lock Screen):
    - rtlogon-lock-screen;
    - lightdm-rtlogon-greeter;
    - rtlogon-lockpam.
- rtlogon\_log.

### Описание компонентов

- **rtlogon-cli** – консольная утилита, предназначенная для:
  - настройки ОС для работы с 2ФА;
  - реконфигурации ОС для работы с 2ФА;
  - отключения настроек ОС для работы с 2ФА;
  - создания и удаления 2ФА;
  - создания запроса на получение сертификата УЗ и генерации самоподписанного сертификата (ключевая пара при этом записывается на ключевой носитель);
  - смены PIN-кода;
  - предоставление информации о ключевом носителе, конфигурации rtlogon и параметрах настроенной локальной 2ФА;
  - сбора лог-файла с информацией о системе и ее логами;
  - экспорта лог-файлов, конфигурационных файлов и файлов с параметрами настроенной локальной 2ФА.
- **rtlogon\_** **event-** **monitor** – приложение-сервис, предназначенный для:
  - контроля запуска системного экрана блокировки (Lock Screen);
  - контроля за операциями над ключевым носителем, использовавшимся при последней аутентификации;
  - выполнения политики ОС при отключении ключевого носителя от ПК во время активной пользовательской сессии.
- **pam\_** **rtlogon.** **so** – PAM-модуль, интегрируемый в ОС Linux. Предназначен для аутентификации пользователя с настроенной 2ФА;
- **GUI** – набор компонентов, реализующих графический пользовательский интерфейс для аутентификации пользователя в ОС:
  - **Экран приветствия** **(Greeter)**:
    - **libfly-** **dmgreet\_** **rtlogon.** **so** – библиотека (плагин) для экрана приветствия ОС Astra Linux;
    - **lightdm-** **rtlogon-** **greeter** – универсальное приложение, реализующее экраны приветствия и блокировки для экранного менеджера LightDM.
  - **Экран блокировки (Lock Screen)**:
    - **rtlogon-lock-screen** – приложение экрана блокировки для ОС Astra Linux;
    - **lightdm-** **rtlogon-** **greeter** – универсальное приложение, реализующее экраны приветствия и блокировки для экранного менеджера LightDM;
    - **rtlogon-lockpam** – PAM-приложение для экрана блокировки ОС Astra Linux.
- **rtlogon\_log** – сервер логирования.

### Описание работы

Для успешного входа в ОС пользователь должен подключить свой ключевой носитель к ПК и ввести PIN-код.

ОС аутентифицирует пользователя на основе данных, размещенных в защищенной памяти ключевого носителя: сложный пароль или закрытый ключ.

rtlogon позволяет задать следующие способы входа в ОС для локальной 2ФА:

- вход только по сертификату;
- вход по сертификату или логину/паролю;
- вход по сложному паролю.

При доменной 2ФА способ входа в ОС настраивается на стороне КД.

Также rtlogon позволяет настроить политику ОС при отключении ключевого носителя от ПК:

- вызов экрана блокировки;

В этом случае для возобновления доступа необходимо снова подключить ключевой носитель к ПК и ввести PIN-код или ввести обычный логин и пароль УЗ.
- продолжение активной пользовательской сессии.

**Доменная 2ФА по сертификату**

Для реализации доменной 2ФА по сертификату необходимо сначала выполнить ее настройку, а потом провести аутентификацию пользователя.

Настройка доменной 2ФА по сертификату выполняется по следующей схеме:

1. Генерация сертификата пользователя:
1. Администратор, используя rtlogon, создает и записывает на ключевой носитель ключевую пару и формирует запрос на получение сертификата пользователя.
2. Администратор передает сформированный запрос в УЦ.
3. УЦ создает сертификат пользователя.
4. Администратор загружает сертификат пользователя на ПК.
2. Настройка доменной 2ФА по сертификату с использованием rtlogon, в процессе которой сертификат загружается на ключевой носитель.

Процесс аутентификации пользователя выполняется по следующей схеме:

1. Пользователь получает ключевой носитель и подключает его к ПК.
2. Пользователь на экране ПК вводит PIN-код, после чего в системе инициируется запрос на аутентификацию и отправляется КД.
3. После получения запроса КД отправляет на ПК набор данных для подписи.
4. С помощью закрытого ключа, хранящегося на ключевом носителе, данные подписываются и возвращаются КД.
5. КД проверяет подпись и при положительном результате аутентифицирует пользователя.

**Локальная 2ФА по сертификату**

Для реализации локальной 2ФА по сертификату необходимо сначала выполнить ее настройку, а потом провести аутентификацию пользователя.

Настройка локальной 2ФА по сертификату выполняется по следующей схеме:

1. Генерация сертификата пользователя.

Администратор, используя rtlogon, создает и записывает на ключевой носитель ключевую пару, создает сертификат и сам его подписывает (генерирует самоподписанный сертификат).
2. Настройка локальной 2ФА по сертификату с использованием rtlogon, в процессе которой сертификат загружается на ключевой носитель.

Процесс аутентификации пользователя выполняется по следующей схеме:

1. Пользователь получает ключевой носитель и подключает его к ПК.
2. Пользователь на экране ПК вводит PIN-код, после чего в системе инициируется запрос на аутентификацию.
3. Система формирует набор данных для подписи.
4. С помощью закрытого ключа, хранящегося на ключевом носителе, данные подписываются.
5. Система проверяет подпись и при положительном результате аутентифицирует пользователя.

**Доменная 2ФА по сложному паролю**

Для реализации доменной 2ФА по сложному паролю необходимо сначала выполнить ее настройку, а потом провести аутентификацию пользователя.

Настройка доменной 2ФА по сложному паролю выполняется с помощью rtlogon. В процессе настройки в КД генерируется сложный пароль и дублируется на ключевой носитель.

Процесс аутентификации пользователя выполняется по следующей схеме:

1. Пользователь получает ключевой носитель и подключает его к ПК.
2. Пользователь на экране ПК вводит PIN-код, после чего в системе инициируется запрос на аутентификацию и отправляется КД.
3. После получения запроса КД отправляет свой запрос на предоставление сложного пароля.
4. Сложный пароль, хранящийся на ключевом носителе, передается КД.
5. КД проводит сверку сложных паролей и при положительном результате аутентифицирует пользователя.

**Локальная 2ФА по сложному паролю**

Для реализации локальной 2ФА по сложному паролю необходимо сначала выполнить ее настройку, а потом провести аутентификацию пользователя.

Настройка локальной 2ФА по сложному паролю выполняется с помощью rtlogon. В процессе настройки в системе генерируется сложный пароль и дублируется на ключевой носитель.

Процесс аутентификации пользователя выполняется по следующей схеме:

1. Пользователь получает ключевой носитель и подключает его к ПК.
2. Пользователь на экране ПК вводит PIN-код, после чего в системе инициируется запрос на аутентификацию.
3. Система проводит сверку сложного пароля, хранящегося на ключевом носителе, и сложного пароля, хранящегося в системе, и при положительном результате аутентифицирует пользователя.

## Поддерживаемое окружение

### Поддерживаемые устройства

Если у ключевого носителя отсутствует криптоядро, он может использоваться в rtlogon только для 2ФА со сложным паролем.

- Рутокен Lite;
- устройства Рутокен ЭЦП 2.0;
- устройства Рутокен ЭЦП 3.0;
- JaCarta ГОСТ;
- JaCarta PKI/ГОСТ.

### Поддерживаемые платформы

- х86\_64;
- ARM64.

### Поддерживаемые ОС

- Astra Linux SE 1.7.2 и новее, SE 1.8.1 и новее (включая работу в режиме замкнутой программной среды (ЗПС)) с уровнями защищенности:
  - Орел;
  - Воронеж;
  - Смоленск.

Для корректной работы rtlogon после обновления ОС Astra Linux необходимо выполнить [реконфигурацию ОС для работы с 2ФА](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%A0%D0%B5%D0%BA%D0%BE%D0%BD%D1%84%D0%B8%D0%B3%D1%83%D1%80%D0%B0%D1%86%D0%B8%D1%8F%D0%9E%D0%A1%D0%B4%D0%BB%D1%8F%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D1%8B%D1%812%D0%A4%D0%90).

- ОС Альт 8 СП, релиз 10;
- ОС Альт 8.4 СП;
- ОС Альт 10;
- РЕД ОС 7.3;
- РЕД ОС 8.

### Поддерживаемые графические окружения

- для ОС Astra Linux – Fly;
- для ОС Альт:
  - KDE;
  - Mate.
- для ОС РЕД ОС:
  - Mate;
  - Cinnamon;
  - KDE.

Графическое окружение GNOME не поддерживается для экранов приветствия и блокировки rtlogon.

Для работы с GNOME необходимо использовать системный экран GDM.

### Поддерживаемые контроллеры домена

- ALD Pro 2.1, 2.4;
- Active Directory;
- FreeIPA 4.9.11;
- Samba DC версии:
  - 4.13.13 и новее – для Astra Linux 1.7;
  - 4.19.12 и новее – для РЕД ОС 7.3;
  - 4.19.7 и новее – для ОС Альт 10;
  - 4.9.18 и новее – для ОС Альт 8 СП, релиз 10.

### Необходимые библиотеки и зависимости

- libpam версии:

  - 1.1.8 – для ОС Astra Linux;

  - 1.1.6 – для ОС Альт;

  - 1.1.8 – для ОС РЕД ОС.
- PKCS#11:

  - librtpkcs11ecp.so версии 2.14.1 и новее – для устройств Рутокен;

  - libjcPKCS11-2.so версии 2.8.0 и новее – для устройств JaCarta.
- Network manager 1.8.9 и новее;

- krb5-pkinit (для доменной сети);

- sssd-1.16.4;

- pam 1.1.8;

- libc6 2.12;

- pcsc-lite 1.8.22;

- pcsc-lite-ccid 1.4.26;

- pcscd 1.8.22;

- liblightdm-qobject 1.16.7 (кроме ОС Astra Linux);

- glib2 2.46.2;

- qt5-qtbase 5.6.1;

- qt5-x11extras-common 5.6.1;

- libqt5-widgets 5.6.1;

- libqt5-concurrent 5.6.1;

- libqt5-svg 5.6.1;

- libqt5-core 5.6.1;

- lightdm 1.16.7 (кроме ОС Astra Linux);

- libqt5x11extras5 5.6.1 (только для ОС Astra Linux);

- lightdm 1.16.7 (только для ОС Astra Linux);

- liblightdm 1.16.7 (только для ОС Astra Linux);

- libglib2.0-0 2.46.2 (кроме ОС Astra Linux).


Все необходимые для rtlogon зависимости присутствуют в репозиториях поддерживаемых ОС, за исключением библиотеки libjcPKCS11-2.so.

Установка библиотеки libjcPKCS11-2.so описана в разделе [Установка библиотеки libjcPKCS11-2.so](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0%D0%B1%D0%B8%D0%B1%D0%BB%D0%B8%D0%BE%D1%82%D0%B5%D0%BA%D0%B8libjcPKCS11-2.so).

## Лицензирование продукта

### Общая информация

Чтобы иметь возможность работать с rtlogon в сети должен быть развернут сервер лицензирования с активированной лицензией программного ключа Guadant DL.

Выбор ПК для установки сервера лицензирования зависит от используемого сценария аутентификации:

- если rtlogon будет использоваться только для локальной аутентификации на распределенных ПК, то рекомендуется устанавливать сервер лицензирования на каждый ПК пользователя;
- если rtlogon будет использоваться для доменной или локальной аутентификации на ПК внутри одной сети, то рекомендуется устанавливать сервер лицензирования на отдельный ПК.

![](https://dev.rutoken.ru/download/attachments/226459656/%D0%A1%D1%85%D0%B5%D0%BC%D0%B0%20%D0%BA%D0%BE%D0%BC%D0%BF%D1%8C%D1%8E%D1%82%D0%B5%D1%80%D0%BD%D0%BE%D0%B9%20%D1%81%D0%B5%D1%82%D0%B8%20%D0%B4%D0%BB%D1%8F%20%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B0_v2.png?version=1&modificationDate=1765436388000&api=v2)

Для корректной работы механизма лицензирования rtlogon необходимо, чтобы все ПК пользователей имели сетевое соединение с ПК сервера лицензирования по порту 3189.

Чтобы подготовить сервер лицензирования и активировать лицензию:

1. [Установите сервер лицензирования](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0%D1%81%D0%B5%D1%80%D0%B2%D0%B5%D1%80%D0%B0%D0%BB%D0%B8%D1%86%D0%B5%D0%BD%D0%B7%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F) в сети.
2. Запустите [утилиту Мастер лицензий Guardant](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%97%D0%B0%D0%BF%D1%83%D1%81%D0%BA%D0%9C%D0%B0%D1%81%D1%82%D0%B5%D1%80%D0%B0%D0%BB%D0%B8%D1%86%D0%B5%D0%BD%D0%B7%D0%B8%D0%B9Guardant).
3. С помощью Мастера лицензий Guardant [активируйте лицензию](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%90%D0%BA%D1%82%D0%B8%D0%B2%D0%B0%D1%86%D0%B8%D1%8F%D0%BB%D0%B8%D1%86%D0%B5%D0%BD%D0%B7%D0%B8%D0%B8) программного ключа Guardant DL на сервере лицензирования.

### Установка сервера лицензирования

Чтобы установить сервер лицензирования:

1. Скачайте с поставочного комплекта установочный пакет grdcontrol для необходимой платформы ПК и ОС:
   - grdcontrol-\[версия grdcontrol\]\_arm64.deb – для ОС Astra Linux и deb-based дистрибутивов на ARM64;
   - grdcontrol-\[версия grdcontrol\]\_amd64.deb – для ОС Astra Linux и deb-based дистрибутивов на x86\_64;
   - grdcontrol-\[версия grdcontrol\]-0.x86\_64.rpm – для ОС РЕД ОС, ОС Альт и rpm-based дистрибутивов на x86\_64.
2. Откройте терминал.
3. Перейдите в каталог расположения установочного пакета.
4. Введите в терминале команду:



**Astra Linux and deb-based distributives**









[?](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#)



|     |
| --- |
| `sudo apt install ./[the name of the installation``package``grdcontrol].deb` |











**Alt Linux**









[?](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#)



|     |
| --- |
| `sudo apt-get install ./[the name of the installation``package``grdcontrol].rpm` |











**RED OS and rpm-based distributives**









[?](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#)



|     |
| --- |
| `sudo dnf install ./[the name of the installation``package``grdcontrol].rpm` |

5. При запросе введите пароль администратора.

Установка сервера лицензирования завершена.

Подробная информация о пакете grdcontrol представлена на официальном сайте [https://dev.guardant.ru/display/GSLK/Guardant+Control+Center](https://dev.guardant.ru/display/GSLK/Guardant+Control+Center).

### Удаление сервера лицензирования

Чтобы удалить сервер лицензирования, введите в терминале команду:

**Astra Linux, Alt Linux and deb-based distributives**

[?](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#)

|     |
| --- |
| `sudo apt-get remove grdcontrol` |

**RED OS and rpm-based distributives**

[?](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#)

|     |
| --- |
| `sudo dnf remove grdcontrol` |

### Запуск Мастера лицензий Guardant

Мастер лицензий Guardant устанавливается автоматически при установке сервера лицензирования.

Файл запуска Мастера лицензий Guardant ( _license\_wizard_) располагается в каталоге _/opt/guardant/grdcontrol_.

Чтобы запустить Мастер лицензий Guardant:

1. Откройте терминал и введите в нем команду:









[?](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#)



|     |
| --- |
| `/opt/guardant/grdcontrol/license_wizard` |









Подробная информация о Мастере лицензий Guardant представлена на официальном сайте[https://dev.guardant.ru/pages/viewpage.action?pageId=85492642](https://dev.guardant.ru/pages/viewpage.action?pageId=85492642).


### Активация лицензии

Чтобы активировать лицензию для rtlogon:

1. Запустите [Мастер лицензий Guardant](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%97%D0%B0%D0%BF%D1%83%D1%81%D0%BA%D0%9C%D0%B0%D1%81%D1%82%D0%B5%D1%80%D0%B0%D0%BB%D0%B8%D1%86%D0%B5%D0%BD%D0%B7%D0%B8%D0%B9Guardant) на сервере лицензирования.
2. В открывшемся окне **Мастер лицензий Guardant** нажмите **Настройки**.
3. В разделе **Настройки**, в поле **Адрес сервера лицензий**, введите адрес _https://getlicense.guardant.ru_.
4. Установите переключатель **Проверять обновления лицензий при запуске автоматически** в активное положение.
5. Нажмите **←Назад**.
6. Нажмите на кнопку **+Активация лицензии**.
7. В поле **На каком компьютере вы хотите использовать лицензию?** выберите **На этом**.
8. Если ПК, на котором выполняется активация лицензии, имеет соединение с сетью Интернет:
1. В поле **Серийный номер** введите полученный серийный номер программного ключа Guardant DL.
2. Нажмите **Получить лицензию**.
9. Если ПК, на котором выполняется активация лицензии, не имеет соединение с сетью Интернет:
01. Нажмите на ссылку **Оффлайн активация**.
02. Выберите вкладку **Новая лицензия** и нажмите **Сохранить**.
03. Сохраните файл запроса.
04. Нажмите **Продолжить**.
05. Перенесите файл запроса на ПК, который имеет соединение с сетью Интернет.
06. Запустите на том ПК Мастер лицензий Guardant.
07. Повторите шаги 2-6.
08. В поле **На каком компьютере вы хотите использовать лицензию?** выберите **На другом**.
09. Нажмите **Продолжить**.
10. Нажмите **Выбрать файл** и откройте перенесенный на этот ПК файл запроса.
11. Введите в поле полученный серийный номер программного ключа Guardant DL.
12. Нажмите **Активировать новую лицензию**.
13. В поле **Готово** нажмите **Сохранить**.
14. Сохраните файл лицензии и перенесите его на ПК, у которого нет соединения с сетью Интернет.
15. Если Мастер лицензий Guardant был закрыт на этом ПК:
       1. Повторите шаги 1, 6, 7.
       2. Нажмите на ссылку **Оффлайн активация**.
       3. Нажмите **Продолжить**.
       4. Нажмите **Продолжить, у меня есть лицензия**.
       5. Нажмите **Выбрать файл**.
       6. Выберите файл лицензии и нажмите **Открыть**.
16. Если Мастер лицензий Guardant не был закрыт на этом ПК:
       1. Нажмите **Продолжить, у меня есть лицензия**.
       2. Нажмите **Выбрать файл**.
       3. Выберите файл лицензии и нажмите **Открыть**.

Лицензия активирована.

## Настройка ПК для работы c rtlogon

Для работы с rtlogon необходимо:

- [настроить Network manager для ОС Astra Linux](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%9D%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0Networkmanager%D0%B4%D0%BB%D1%8F%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%D0%BF%D1%80%D0%B8%D0%B2%D0%B5%D1%82%D1%81%D1%82%D0%B2%D0%B8%D1%8F%D0%9E%D0%A1AstraLinux)(опционально) – если требуется работа с сетью из экрана приветствия;
- [ввести ПК в домен](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%92%D0%B2%D0%BE%D0%B4%D0%9F%D0%9A%D0%B2%D0%B4%D0%BE%D0%BC%D0%B5%D0%BD) – для работы с доменной 2ФА;
- [загрузить корневой сертификат или сертификаты цепочки доверия УЦ](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%97%D0%B0%D0%B3%D1%80%D1%83%D0%B7%D0%BA%D0%B0%D0%BA%D0%BE%D1%80%D0%BD%D0%B5%D0%B2%D0%BE%D0%B3%D0%BE%D1%81%D0%B5%D1%80%D1%82%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%82%D0%B0%D0%B8%D0%BB%D0%B8%D1%81%D0%B5%D1%80%D1%82%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%82%D0%BE%D0%B2%D1%86%D0%B5%D0%BF%D0%BE%D1%87%D0%BA%D0%B8%D0%B4%D0%BE%D0%B2%D0%B5%D1%80%D0%B8%D1%8F%D0%A3%D0%A6%D0%BD%D0%B0%D0%9F%D0%9A) – для работы с доменной 2ФА.

В целях поддержания безопасности сети предприятия рекомендуется для ввода ПК в домен использовать УЗ, имеющую права только на выполнение данной операции.

### Настройка Network manager для экрана приветствия ОС Astra Linux

В ОС Astra Linux функциональность Network manager в экране приветствия по умолчанию недоступна.

Чтобы включить возможность управления сетевыми подключениями через экран приветствия:

1. Запустите **Панель управления**.
2. На вкладке **Безопасность** выберите **Санкции****PolicyKit-1**.

![](https://dev.rutoken.ru/download/attachments/226459656/Network%20manager_1.png?version=1&modificationDate=1765436828000&api=v2)

3. В открывшемся окне **Санкции** **PolicyKit-1** выберите **org.freedesktop**.

4. В раскрывшемся списке выберите **NetworkManager**, далее**settings**, далее**Allow cоntrol of network connection**.

![](https://dev.rutoken.ru/download/attachments/226459656/Network%20manager_2.png?version=1&modificationDate=1765436889000&api=v2)

5. При открытии окна **Требуется аутентификация – Агент PolicyKit1 от KDE** введите пароль УЗ. Нажмите **Да**.

![](https://dev.rutoken.ru/download/attachments/226459656/Network%20manager_3.png?version=1&modificationDate=1765436933000&api=v2)

6. В окне **Санкции** **PolicyKit-1**, в поле **Удаленная сессия** из выпадающего списка выберите **Разрешить**. Нажмите**Сохранить**.

![](https://dev.rutoken.ru/download/attachments/226459656/Network%20manager_4.png?version=1&modificationDate=1765436976000&api=v2)

7. При открытии окна **Требуется аутентификация – Агент PolicyKit1 от KDE** введите пароль УЗ. Нажмите **Да**.
8. Закройте все окна.

### Ввод ПК в домен

#### **Active Directory**

**ОС Astra Linux**

Чтобы ввести ПК в домен:

1. Добавьте в настройки сетевого подключения IP-адрес DNS-сервера предприятия.
2. Установите утилиту _astra-ad-sssd-client_ для ввода ПК в домен.
3. Используя утилиту, введите ПК в домен.

Подробная инструкция по вводу ПК в домен представлена на официальном сайте [https://wiki.astralinux.ru/pages/viewpage.action?pageId=27361515](https://wiki.astralinux.ru/pages/viewpage.action?pageId=27361515).
4. Установите поиск kerberos-имени и настроек домена через DNS. Для этого необходимо задать значение **True** следующим параметрам в разделе \[libdefaults\] файла /etc/krb5.conf:









[?](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#)



|     |
| --- |
| `dns_lookup_realm = True`<br>`dns_lookup_kdc = True` |

5. Перезагрузите ПК.

Для удобства ввода ПК в домен можно использовать скрипт _configure\_ad.sh_ для ОС Astra Linux из комплекта поставки, заменив в нем значения параметров на требуемые.

После ввода ПК в домен скрипт нужно удалить, т.к. он содержит данные УЗ.

**ОС РЕД ОС**

Чтобы ввести ПК в домен:

1. Добавьте в настройки сетевого подключения IP-адрес DNS-сервера предприятия.
2. Установите утилиту _join-to-domain_ для ввода ПК в домен.
3. Используя утилиту, введите ПК в домен.

Подробная инструкция по вводу ПК в домен представлена на официальном сайте [https://redos.red-soft.ru/base/arm/arm-domen/arm-msad/prejoindomain/](https://redos.red-soft.ru/base/arm/arm-domen/arm-msad/prejoindomain/).
4. Перезагрузите ПК.

Для удобства ввода ПК в домен можно использовать скрипт _configure\_ad.sh_ для ОС РЕД ОС из комплекта поставки, заменив в нем значения параметров на требуемые.

После ввода ПК в домен скрипт нужно удалить, т.к. он содержит данные УЗ.

**ОС Альт**

Все шаги по вводу ПК в домен необходимо выполнять в одном терминале.

Чтобы ввести ПК в домен:

1. Замените \[ _hostname\]_ на \[ _current\_hostname.domain\]_.
2. Отключите плагин _etcnet-alt_ для NetworkManager.
3. Перезапустите NetworkManager.
4. Подключитесь к новому сетевому соединению.
5. Добавьте в настройки сетевого подключения IP-адрес DNS-сервера предприятия.
6. Установите утилиту _task-auth-ad-sssd_ для ввода ПК в домен.
7. Используя утилиту, введите ПК в домен.

Подробная инструкция по вводу ПК в домен представлена на официальном сайте [https://docs.altlinux.org/ru-RU/alt-education/10.0/html/alt-education/activedirectory-login--chapter.html](https://docs.altlinux.org/ru-RU/alt-education/10.0/html/alt-education/activedirectory-login--chapter.html).
8. Перезагрузите ПК.

Для удобства ввода ПК в домен можно использовать скрипт _configure\_ad.sh_ для ОС Альт из комплекта поставки, заменив в нем значения параметров на требуемые.

После ввода ПК в домен скрипт нужно удалить, т.к. он содержит данные УЗ.

#### **FreeIPA**

**ОС Astra Linux**

Чтобы ввести ПК в домен:

1. Настройте разрешение имен. Для этого в файле _/etc/hosts_:
1. Замените _\[127.0.1.1 hostname\]_ на _\[IP-адрес\_ПК hostname.domain\]_. При этом запись _hostname.domain_ должна быть уникальной и отсутствовать в домене.
2. Добавьте IP-адрес сервера FreeIPA.
2. Добавьте в настройки сетевого подключения IP-адрес DNS-сервера предприятия.
3. Установите утилиту _astra-freeipa-client_ для ввода ПК в домен.
4. Используя утилиту, введите ПК в домен.

Подробная инструкция по вводу ПК в домен представлена на официальном сайте [https://wiki.astralinux.ru/pages/viewpage.action?pageId=60359750](https://wiki.astralinux.ru/pages/viewpage.action?pageId=60359750).
5. Перезагрузите ПК.

Для удобства ввода ПК в домен можно использовать скрипт _configure\_freeipa.sh_ для ОС Astra Linux из комплекта поставки, заменив в нем значения параметров на требуемые.

После ввода ПК в домен скрипт нужно удалить, т.к. он содержит данные УЗ.

**ОС РЕД ОС**

Чтобы ввести ПК в домен:

1. Замените _\[hostname\]_ на _\[client\_name.domain\]_.
2. Добавьте в настройки сетевого подключения IP-адрес DNS-сервера предприятия.
3. Установите утилиту _ipa-client_ для ввода ПК в домен.
4. Используя утилиту, введите ПК в домен.

Подробная инструкция по вводу ПК в домен представлена на официальном сайте [https://redos.red-soft.ru/base/redos-7\_3/7\_3-administation/7\_3-domain-redos/7\_3-installation-ipa/7\_3-ipa-clients/](https://redos.red-soft.ru/base/redos-7_3/7_3-administation/7_3-domain-redos/7_3-installation-ipa/7_3-ipa-clients/).
5. Перезагрузите ПК.

Для удобства ввода ПК в домен можно использовать скрипт _configure\_freeipa.sh_ для ОС РЕД ОС из комплекта поставки, заменив в нем значения параметров на требуемые.

После ввода ПК в домен скрипт нужно удалить, т.к. он содержит данные УЗ.

**ОС Альт**

Для ОС Альт все шаги по вводу ПК в домен необходимо выполнять в одном терминале.

Чтобы ввести ПК в домен:

1. Замените _\[hostname\]_ на _\[hostname.domain\]_.
2. Отключите плагин etcnet-alt для NetworkManager.
3. Перезапустите NetworkManager.
4. Подключитесь к новому сетевому соединению.
5. Добавьте в настройки сетевого подключения IP-адрес DNS-сервера предприятия.
6. Установите утилиту _freeipa-client_ для ввода ПК в домен.
7. Используя утилиту, введите ПК в домен.

Подробная инструкция по вводу ПК в домен представлена на официальном сайте [https://docs.altlinux.org/ru-RU/alt-kworkstation/10.1/html/alt-kworkstation/ch57.html](https://docs.altlinux.org/ru-RU/alt-kworkstation/10.1/html/alt-kworkstation/ch57.html).
8. Перезагрузите ПК.

Для удобства ввода ПК в домен можно использовать скрипт _configure\_freeipa.sh_ для ОС Альт из комплекта поставки, заменив в нем значения параметров на требуемые.

После ввода ПК в домен скрипт нужно удалить, т.к. он содержит данные УЗ.

#### **ALDPro**

**ОС Astra Linux**

Чтобы ввести ПК в домен:

1. Настройте разрешения имен. В файл _/etc/hosts_ необходимо добавить IP-адрес КД ALDPro.
2. Добавьте репозитории ALDPro в каталог _/etc/apt/sources.list.d/_.
3. Добавьте в настройки сетевого подключения IP-адрес DNS-сервера предприятия.
4. Установите утилиту _aldpro-client_ для ввода ПК в домен.
5. Используя утилиту, введите ПК в домен.
6. Перезагрузите ПК.

Для удобства ввода ПК в домен можно использовать скрипт _configure\_ald\_pro.sh_ для ОС Astra Linux из комплекта поставки, заменив в нем значения параметров на требуемые.

После ввода ПК в домен скрипт нужно удалить, т.к. он содержит данные УЗ.

#### **Samba DC**

**ОС Astra Linux**

Чтобы ввести ПК в домен:

1. Добавьте в настройки сетевого подключения IP-адрес DNS-сервера предприятия.
2. Установите утилиту _astra-ad-sssd-client_ для ввода ПК в домен.
3. Используя утилиту, введите ПК в домен.

Подробная инструкция по вводу ПК в домен представлена на официальном сайте [https://wiki.astralinux.ru/pages/viewpage.action?pageId=27361515](https://wiki.astralinux.ru/pages/viewpage.action?pageId=27361515).
4. Включите поиск kerberos-имени домена через DNS.
5. Включите поиск kerberos-настроек домена через DNS.
6. Перезагрузите ПК.

Для удобства ввода ПК в домен можно использовать скрипт _configure\_samba.sh_ для ОС Astra Linux из комплекта поставки, заменив в нем значения параметров на требуемые.

После ввода ПК в домен скрипт нужно удалить, т.к. он содержит данные УЗ.

**ОС РЕД ОС**

Чтобы ввести ПК в домен:

1. Добавьте в настройки сетевого подключения IP-адрес DNS-сервера предприятия.
2. Установите утилиту _join-to-domain_ для ввода ПК в домен.
3. Используя утилиту, введите ПК в домен.

Подробная инструкция по вводу ПК в домен представлена на официальном сайте [https://redos.red-soft.ru/base/arm/arm-domen/arm-msad/prejoindomain/](https://redos.red-soft.ru/base/arm/arm-domen/arm-msad/prejoindomain/).
4. Перезагрузите ПК.

Для удобства ввода ПК в домен можно использовать скрипт _configure\_samba.sh_ для ОС РЕД ОС из комплекта поставки, заменив в нем значения параметров на требуемые.

После ввода ПК в домен скрипт нужно удалить, т.к. он содержит данные УЗ.

**ОС Альт**

Все шаги по вводу ПК в домен необходимо выполнять в одном терминале.

Чтобы ввести ПК в домен:

1. Замените \[ _hostname\]_ на \[ _current\_hostname.domain\]_.
2. Отключите плагин _etcnet-alt_ для NetworkManager.
3. Перезапустите NetworkManager.
4. Подключитесь к новому сетевому соединению.
5. Добавьте в настройки сетевого подключения IP-адрес DNS-сервера предприятия.
6. Установите утилиту _task-auth-ad-sssd_ для ввода ПК в домен.
7. Используя утилиту, введите ПК в домен.

Подробная инструкция по вводу ПК в домен представлена на официальном сайте [https://docs.altlinux.org/ru-RU/alt-education/10.0/html/alt-education/activedirectory-login--chapter.html](https://docs.altlinux.org/ru-RU/alt-education/10.0/html/alt-education/activedirectory-login--chapter.html).
8. Перезагрузите ПК.

Для удобства ввода ПК в домен можно использовать скрипт _configure\_samba.sh_ для ОС Альт из комплекта поставки, заменив в нем значения параметров на требуемые.

После ввода ПК в домен скрипт нужно удалить, т.к. он содержит данные УЗ.

### Проверка ввода ПК в домен

Чтобы проверить, введен ли ПК в домен:

1. Откройте файл _/etc/sssd/sssd.conf_.
2. Убедитесь, что в секции _\[sssd\]_ параметру _domains_ присвоено значение.

**Пример**.

[?](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#)

|     |
| --- |
| `[sssd]`<br>`domains = some.domain` |

### Загрузка корневого сертификата или сертификатов цепочки доверия УЦ на ПК

Если сертификат является промежуточным в цепочке доверия УЦ, то файл сертификата УЦ на ПК должен содержать все промежуточные сертификаты до корневого.

Если сертификат пользователя содержит поле **Certificate Authority Information Access** с адресом сервера корневых сертификатов, то промежуточные сертификаты можно не указывать при [настройке ОС для работы с 2ФА](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%9D%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0%D0%9E%D0%A1%D0%B4%D0%BB%D1%8F%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D1%8B%D1%812%D0%A4%D0%90).

Составить файл со всеми доверенными сертификатами можно 2-мя способами.

**1 способ**.

Записать все сертификаты в один файл с помощью команды `cat`:

[?](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#)

|     |
| --- |
| `cat cert1.pem cert2.pem cert3.pem >> ca_certs.pem` |

**2 способ**.

Загрузить сертификаты в контейнер в формате p7b.

#### FreeIPA и ALDPro

##### Корневой сертификат

Корневой сертификат автоматически загружается на ПК в процессе [ввода ПК в домен](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%92%D0%B2%D0%BE%D0%B4%D0%9F%D0%9A%D0%B2%D0%B4%D0%BE%D0%BC%D0%B5%D0%BD). Дополнительных действий выполнять не требуется.

##### Сертификаты цепочки доверия УЦ

Для загрузки сертификатов цепочки доверия УЦ на ПК:

1. Введите команду:









[?](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#)



|     |
| --- |
| `ipa ca-find` |









В терминале появится список с названием всех сертификатов.

2. Введите команду:









[?](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#)



|     |
| --- |
| `ipa ca-show``"$CA_NAME"``--chain --certificate-out chain.pem` |









На ПК будут загружены все сертификаты цепочки доверия УЦ.

3. Запишите все сертификаты в один файл с помощью команды `cat` или используйте контейнер p7b.

#### Active Directory

Для загрузки корневого сертификата или сертификатов цепочки доверия УЦ на ПК:

1. Зайдите на веб-интерфейс УЦ КД. Адрес по умолчанию _https://\[domain\]/certsrv_.
2. Выберите **Загрузка сертификата ЦС, цепочки сертификатов или CRL**.

![](https://dev.rutoken.ru/download/attachments/226459656/AD_1.png?version=1&modificationDate=1765437525000&api=v2)

3. В поле **Метод шифрования** выберите **Base 64**.
4. Выберите **Загрузка сертификата ЦС** или **Загрузка цепочки сертификатов ЦС**. Загрузка на ПК начнется автоматически.

Цепочка сертификатов загружается в виде файла – контейнера формата p7b.

![](https://dev.rutoken.ru/download/thumbnails/226459656/AD_2.png?version=1&modificationDate=1765437570000&api=v2)

Если присутствует необходимость извлечь сертификаты из контейнера, можно воспользоваться утилитой openssl.

#### Samba DC

КД Samba DC не имеет встроенного УЦ.

Схема загрузки корневого сертификата или сертификатов цепочки доверия УЦ на ПК пользователя зависит от выбранных администратором УЦ и выполненных на них настроек.

## Установка rtlogon

Чтобы установить rtlogon:

1. Скопируйте с поставочного диска или скачайте с официального сайта Компании "Актив" установочный пакет rtlogon для необходимой платформы ПК и ОС:
   - rutokenlogon-\[версия rtlogon\]-astra1\_arm64.deb – для ОС Astra Linux на ARM64;
   - rutokenlogon\_\[версия rtlogon\]-astra1\_amd64.deb – для ОС Astra Linux на x86\_64;
   - rutokenlogon-\[версия rtlogon\]-alt1.aarch64.rpm – для ОС Альт на ARM64;
   - rutokenlogon-\[версия rtlogon\]-alt1.x86\_64.rpm – для ОС Альт на x86\_64;
   - rutokenlogon-\[версия rtlogon\]-1.aarch64.rpm – для ОС РЕД ОС и rpm-based дистрибутивов на ARM64;
   - rutokenlogon-\[версия rtlogon\]-1.x86\_64.rpm – для ОС РЕД ОС и rpm-based дистрибутивов на x86\_64;
   - rutokenlogon\_\[версия rtlogon\]-1\_arm64.deb – для deb-based дистрибутивов на ARM64;
   - rutokenlogon\_\[версия rtlogon\]-1\_amd64.deb – для deb-based дистрибутивов на x86\_64.
2. Откройте терминал.
3. Перейдите в каталог расположения установочного пакета.
4. Введите в терминале команду:



**Astra Linux and deb-based distributives**









[?](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#)



|     |
| --- |
| `sudo apt install ./[the name of the installation``package``rtlogon].deb` |











**Alt Linux**









[?](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#)



|     |
| --- |
| `sudo apt-get install ./[the name of the installation``package``rtlogon].rpm` |











**RED OS and rpm-based distributives**









[?](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#)



|     |
| --- |
| `sudo dnf install ./[the name of the installation``package``rtlogon].rpm` |

5. При запросе введите пароль администратора.
6. При запросе подтвердите продолжение установки.
7. Дождитесь окончания установки.
8. Введите в терминале команду:









[?](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#)



|     |
| --- |
| `rtlogon-cli --version` |

9. Проверьте наличие в терминале сообщения с номером установленной версии rtlogon.

![](https://dev.rutoken.ru/download/attachments/226459656/Check%20install%20Logon.png?version=1&modificationDate=1765437700000&api=v2)

Установка rtlogon завершена.

## Установка библиотеки libjcPKCS11-2.so

Для работы rtlogon с устройствами JaCarta необходимо скачать и установить библиотеку libjcPKCS11-2.so:

1. Зайдите на сайт [https://www.aladdin-rd.ru/support/downloads/jacarta/](https://www.aladdin-rd.ru/support/downloads/jacarta/).
2. На странице в разделе **Linux Дистрибутивы** выберите **ПК "Единый Клиент JaCarta 3.3"** для соответствующей ОС.

![](https://dev.rutoken.ru/download/attachments/226459656/Library_jacarta.png?version=1&modificationDate=1765437812000&api=v2)

3. На открывшейся странице нажмите кнопку **Скачать**.
4. Распакуйте скачанный архив.
5. Откройте терминал.
6. Перейдите в терминале в каталог распакованного архива.
7. Введите команду:



**Astra Linux and deb-based distributives**









[?](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#)



|     |
| --- |
| `sudo apt install ./jcpkcs11-``2``[*].deb` |











**Alt Linux**









[?](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#)



|     |
| --- |
| `sudo apt-get install ./jcpkcs11-``2``[*].rpm` |











**RED OS and rpm-based distributives**









[?](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#)



|     |
| --- |
| `sudo dnf install ./jcpkcs11-``2``[*].rpm` |

8. Переместите библиотеку _libjcPKCS11-2.so_ из каталога _/usr/lib64_ в каталог _/opt/aktivco/rtlogon/pkcs_:









[?](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#)



|     |
| --- |
| `sudo cp /usr/lib64/libjcPKCS11-``2``.so /opt/aktivco/rtlogon/pkcs/` |









Установка библиотеки завершена.


## Команды и общие параметры rtlogon

| Команда/параметр | Описание |
| **Команды** |
| ```<br>configure<br>``` | Настройка ОС для работы с 2ФА |
| ```<br>reconfigure<br>``` | Реконфигурация ОС для работы с 2ФА |
| ```<br>unconfigure<br>``` | Отключение настроек ОС для работы с 2ФА |
| ```<br>setup-auth<br>``` | Настройка 2ФА |
| ```<br>unsetup-auth<br>``` | Удаление 2ФА |
| ```<br>create-cert<br>``` | Создание запроса на получение сертификата, генерация самоподписанного сертификата |
| ```<br>change-pin<br>``` | Смена PIN-кода токена |
| ```<br>collect-log<br>``` | Экспорт конфигурационных файлов, лог-файлов и файла с параметрами локальной 2ФА |
| ```<br>info<br>``` | Запрос информации о конфигурации rtlogon и параметрах локальной 2ФА |
| **Параметры** |
| ```<br>-h<br>```<br>```<br>или<br>```<br>```<br>--help<br>``` | Получение перечня команд и общих параметров rtlogon.<br>При вызове с командой rtlogon выводит перечень ее параметров |
| ```<br>--version<br>``` | Получение информации о версии установленного rtlogon |

## Обновление rtlogon

Для обновления rtlogon необходимо установить новый пакет. Старый пакет при этом удалять не требуется.

## Удаление rtlogon

При удалении rtlogon можно потерять доступ к УЗ с настроенной 2ФА по сложному паролю. Поэтому **перед удалением rtlogon рекомендуется [отключить настройки ОС для работы с 2ФА](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%9E%D1%82%D0%BA%D0%BB%D1%8E%D1%87%D0%B5%D0%BD%D0%B8%D0%B5%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B5%D0%BA%D0%9E%D0%A1%D0%B4%D0%BB%D1%8F%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D1%8B%D1%812%D0%A4%D0%90)**и перезагрузить ПК.

После удаления rtlogon администратор должен заново задать пароли для входа в ОС УЗ, у которых была настроена 2ФА со сложным паролем.

Для удаления rtlogon в ОС Альт и ОС РЕД ОС необходим корректный (неповрежденный) файл _rtlogon.conf_.

Если есть вероятность повреждения файла из-за выхода из строя жесткого диска или действий администратора, рекомендуется сделать бэкап файла _/etc/rtlogon/rtlogon.conf_  после установки и настройки rtlogon.

Для удаления rtlogon необходимо вручную восстановить конфигурационный файл, используя бэкап, или отключить настройки ОС для работы с 2ФА, выполнив команду [rtlogon-cli unconfigure](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%9E%D1%82%D0%BA%D0%BB%D1%8E%D1%87%D0%B5%D0%BD%D0%B8%D0%B5%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B5%D0%BA%D0%9E%D0%A1%D0%B4%D0%BB%D1%8F%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D1%8B%D1%812%D0%A4%D0%90).

При удалении rtlogon могут быть удалены все его зависимости, в том числе экранный менеджер LightDM. Удаление экранного менеджера LightDM из графической сессии, при входе в которую он использовался, приведет к закрытию текущей сессии пользователя и необходимости перезагрузить ПК.

Для удаления rtlogon:

1. Введите команду:



**Astra Linux and deb-based distributives**









[?](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#)



|     |
| --- |
| `sudo apt remove rutokenlogon` |











**Alt Linux**









[?](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#)



|     |
| --- |
| `sudo apt-get remove rutokenlogon` |











**RED OS and rpm-based distributives**









[?](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#)



|     |
| --- |
| `sudo dnf remove rutokenlogon` |

2. При запросе введите пароль администратора.

Удаление rtlogon с ПК завершено.

## Настройка ОС для работы с 2ФА

При настройке ОС выполняются следующие операции:

- настройка сервисa rtlogon\_event-monitor;
- изменение конфигурации PAM-модулей ОС для внедрения pam\_rtlogon.so;
- внедрение плагина для экрана приветствия и экрана блокировки (для ОС Astra Linux и дистрибутивов, поддерживающих экранный менеджер LightDM);
- конфигурирование pam\_sssd (для доменной аутентификации).

В плагине для экрана приветствия, основывающемся на экранном менеджере LightDM, поддерживаются языки раскладки клавиатуры, которые были добавлены через localectl.

При вызове экрана блокировки в дистрибутивах, поддерживающих скринсейверы, возможно его непроизвольное открытие в другом tty.

Для проверки поддержки ОС скринсейвера используется команда` [gui]-screensaver-command --query`.

Перед настройкой ОС для работы с доменной 2ФА по сертификату на ПК должен быть [загружен корневой сертификат или сертификаты цепочки доверия УЦ](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%97%D0%B0%D0%B3%D1%80%D1%83%D0%B7%D0%BA%D0%B0%D0%BA%D0%BE%D1%80%D0%BD%D0%B5%D0%B2%D0%BE%D0%B3%D0%BE%D1%81%D0%B5%D1%80%D1%82%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%82%D0%B0%D0%B8%D0%BB%D0%B8%D1%81%D0%B5%D1%80%D1%82%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%82%D0%BE%D0%B2%D1%86%D0%B5%D0%BF%D0%BE%D1%87%D0%BA%D0%B8%D0%B4%D0%BE%D0%B2%D0%B5%D1%80%D0%B8%D1%8F%D0%A3%D0%A6%D0%BD%D0%B0%D0%9F%D0%9A).

Перед настройкой ОС для работы с 2ФА должен быть:

- установлен в сети или на ПК пользователя [сервер лицензирования](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0%D1%81%D0%B5%D1%80%D0%B2%D0%B5%D1%80%D0%B0%D0%BB%D0%B8%D1%86%D0%B5%D0%BD%D0%B7%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F);
- [на сервере лицензирования](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%90%D0%BA%D1%82%D0%B8%D0%B2%D0%B0%D1%86%D0%B8%D1%8F%D0%BB%D0%B8%D1%86%D0%B5%D0%BD%D0%B7%D0%B8%D0%B8) [активирована лицензия](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%90%D0%BA%D1%82%D0%B8%D0%B2%D0%B0%D1%86%D0%B8%D1%8F%D0%BB%D0%B8%D1%86%D0%B5%D0%BD%D0%B7%D0%B8%D0%B8) rtlogon.

Для настройки ОС введите в терминале команду:

[?](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#)

|     |
| --- |
| `rtlogon-cli configure [command parameters]` |

**Command parameters**

| Параметр | Описание | Значение по умолчанию | Наличие параметра в команде | Условие применения |
| --- | --- | --- | --- | --- |
| ```<br>--domain arg<br>``` | Тип КД.<br>Допустимые значения: ipa, aldpro, ad, samba | - | Обязательно | Необходимо настроить ОС для работы с доменной 2ФА |
| ```<br>--local<br>``` | Настройка ОС для работы с локальной 2ФА | - | Обязательно | Необходимо настроить ОС для работы с локальной 2ФА.<br>Запрещена одновременная установка с параметром <br>`--domain`. <br>Эти 2 параметра являются взаимоисключающими |
| ```<br>--license-server arg<br>``` | Адрес сервера лицензирования.<br>В качестве адреса можно указать:<br>- IP-адрес;<br>- DNS-имя.<br>Для локального сервера лицензирования:<br>- IP-адрес – 127.0.0.1;<br>- DNS-имя – localhost | - | Обязательно | Всегда |
| ```<br>--ca-cert arg<br>``` | Путь к файлу, содержащему корневой сертификат или сертификаты цепочки доверия УЦ | /etc/ipa/ca.crt | Опционально | Необходимо настроить ОС для работы с доменной 2ФА по сертификату |
| ```<br>--use-system-gui arg<br>``` | Использование системных экранов приветствия и блокировки.<br>Допустимые значения: yes, no | no | Опционально | Если необходимо использовать **системные** экраны приветствия и блокировки, указывать значение **yes**.<br>Если необходимо использовать экраны приветствия и блокировки **rtlogon**, указывать значение **no** |

При выборе системных экранов приветствия и блокировки в настройках ОС для работы с 2ФА возможно появление следующих ограничений на экранах:

- недоступна разблокировка PIN-кода Пользователя;
- недоступен просмотр списка пользователей на токене, под которыми можно войти в систему;
- недоступны настройки сети;
- некорректный вывод запроса на предоставление PIN-кода для аутентификации – система запрашивает PIN-код, а на экран выводится сообщение с запросом пароля.

Поэтому при настройке **необходимо указывать использование экранов приветствия и блокировки rtlogon для всех ОС, кроме Astra Linux SE 1.8.1**. Эта ОС работает только с системными экранами приветствия и блокировки.

Если есть вероятность повреждения конфигурационного файла rtlogon из-за выхода из строя жесткого диска или действий администратора, рекомендуется после настройки или [реконфигурации](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%A0%D0%B5%D0%BA%D0%BE%D0%BD%D1%84%D0%B8%D0%B3%D1%83%D1%80%D0%B0%D1%86%D0%B8%D1%8F%D0%9E%D0%A1%D0%B4%D0%BB%D1%8F%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D1%8B%D1%812%D0%A4%D0%90) ОС для работы с 2ФА сделать бэкап файла _/etc/rtlogon/rtlogon.conf_.

Неповрежденный файл _rtlogon.conf_ необходим для корректного удаления rtlogon.

Внесение изменений вручную в файл _rtlogon.conf_ запрещено. Повреждение файла может привести к невозможности использования rtlogon.

**Пример.**

[?](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#)

|     |
| --- |
| `sudo rtlogon-cli configure --local --license-server``127.0``.``0.1``--use-system-gui yes`<br>`//OS setup for local 2FA; using system Greeter and Lock Screen`<br>`sudo rtlogon-cli configure --domain ad --license-server TEST-PC --ca-cert сert.pem`<br>`//OS setup for domain certificate 2FA` |

## Реконфигурация ОС для работы с 2ФА

Перед изменением настроек ОС должна быть сконфигурирована для работы с 2ФА, т.е. должна быть выполнена команда [rtlogon-cli configure](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%9D%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0%D0%9E%D0%A1%D0%B4%D0%BB%D1%8F%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D1%8B%D1%812%D0%A4%D0%90).

Для реконфигурации ОС введите в терминале команду:

[?](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#)

|     |
| --- |
| `sudo rtlogon-cli reconfigure [command parameters]` |

**Command parameters**

| Параметр | Описание | Наличие параметра в команде | Условие применения |
| --- | --- | --- | --- |
| ```<br>--domain arg<br>``` | Тип КД.<br>Допустимые значения: ipa, aldpro, ad, samba | Опционально | Необходимо настроить ОС для работы с доменной 2ФА |
| ```<br>--local<br>``` | Настройка ОС для работы с локальной 2ФА | Опционально | Необходимо настроить ОС для работы с локальной 2ФА.<br>Запрещена одновременная установка с параметром <br>--domain.<br>Эти 2 параметра являются взаимоисключающими |
| ```<br>--license-server<br>``` | Адрес сервера лицензирования.<br>В качестве адреса можно указать:<br>- IP-адрес;<br>- DNS-имя.<br>Для локального сервера лицензирования:<br>- IP-адрес – 127.0.0.1;<br>- DNS-имя – localhost | Опционально | Необходимо изменить адрес сервера лицензирования |
| ```<br>--ca-cert arg<br>``` | Путь к файлу, содержащему корневой сертификат или сертификаты цепочки доверия УЦ | Опционально | Необходимо настроить ОС для работы с доменной 2ФА по сертификату |
| ```<br>--use-system-gui arg<br>``` | Использование системных экранов приветствия и блокировки.<br>Допустимые значения: yes, no | Опционально | Если необходимо использовать **системные** экраны приветствия и блокировки, указывать значение **yes**<br>Если необходимо использовать экраны приветствия и блокировки **rtlogon**, указывать значение **no** |

Если команда вызывается без параметров, то для настройки ОС будут использоваться значения, указанные в конфигурационном файле _/etc/rtlogon/rtlogon.conf._

Реконфигурацию ОС без указания параметров рекомендуется использовать в следующих случаях:

- после выхода из строя ОС;
- после обновления ОС (для Astra Linux).

Рекомендуется использовать экраны приветствия и блокировки rtlogon.

## Отключение настроек ОС для работы с 2ФА

Перед отключением настроек ОС для работы с 2ФА необходимо выполнить команду [rtlogon-cli unsetup-auth](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%A3%D0%B4%D0%B0%D0%BB%D0%B5%D0%BD%D0%B8%D0%B52%D0%A4%D0%90) для УЗ, у которых была настроена локальная 2ФА по сложному паролю.

Чтобы отключить настройки ОС для работы с 2ФА, введите в терминале команду:

[?](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#)

|     |
| --- |
| `sudo rtlogon-cli unconfigure` |

Если конфигурационный файл _/etc/rtlogon/rtlogon.conf_ не повреждён, то в результате выполнения этой команды вернутся в исходное состояние:

- конфигурация PAM-модулей системы и pam\_sssd;
- плагин для системных экранов приветствия и блокировки.

## Проверка сертификатов пользователей на статус "отозванный"

rtlogon поддерживает функцию проверки сертификатов пользователей на статус "отозванный".

Проверка может выполняться с помощью CRL или OCSP.

### CRL

Чтобы включить проверку сертификатов с помощью CRL:

1. Загрузите на ПК CRL-файл(ы).
2. Проверьте, что на ПК загружен корневой сертификат УЦ и сертификаты промежуточных УЦ цепочки доверия.
3. Откройте файл _/etc/sssd/sssd.conf_.
4. В секции \[sssd\], в параметр `certificate_verification` добавьте опцию `crl_file`и задайте для нее путь к CRL-файлу.





Поддерживается только pem-формат CRL-файла.

5. Для игнорирования проверки в случае истечения срока действия CRL-файла добавьте в параметр `certificate_verification`опцию `soft_crl`.





Опцию игнорирования ошибок в цепочке доверия `partial_chain` не рекомендуется включать при работе в домене в связи с его некорректной работой с kerberos.

6. Сохраните изменения в файле.
7. Выполните команду `rtlogon-cli reconfigure` без параметров.

Если опция `crl_file` отсутствует, проверка сертификата пользователя на статус "отозванный" не выполняется.

**Пример.**

[?](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#)

|     |
| --- |
| `[sssd]`<br>`certificate_verification = soft_crl, сrl_file = /PATH/TO/CRL/FILE, ...` |

### OCSP

Включить проверку сертификата на статус "отозванный" с помощью OCSP можно 2-мя способами.

**1 способ**.

URL-адрес сервера OCSP задан в сертификате пользователя, корневом сертификате или сертификате промежуточного УЦ.

**2 способ**.

1. Откройте файл _/etc/sssd/sssd.conf_.
2. В секции \[sssd\], в параметр `certificate_verification` добавьте опцию `ocsp_default_responder```и задайте для нее URL-адрес сервера OCSP.

3. Для игнорирования проверки при недоступности сервера OCSP добавьте в параметр `certificate_verification`опцию `soft_ocsp`.
4. Для отключения проверки сертификата добавьте в параметр `certificate_verification`опцию `no_ocsp.`
5. Сохраните изменения в файле.
6. Выполните команду `rtlogon-cli reconfigure` без параметров.

**Пример.**

[?](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#)

|     |
| --- |
| `/// enabling verification via the sssd.conf and ignoring verification`<br>`[sssd]`<br>`certificate_verification = soft_ocsp, ocsp_default_responder = /OCSP/SERVER/ADDRESS, ...`<br>`/// disabling verification`<br>`[sssd]`<br>`certificate_verification = no_oscp`<br>`/// ignoring verification. The OCSP server URL is specified in the certificate`<br>`[sssd]`<br>`certificate_verification = soft_ocsp` |

## Настройка 2ФА

Перед настройкой доменной 2ФА ОС должна быть сконфигурирована для работы с этим типом аутентификации т.е. должна быть выполнена команда [rtlogon-cli configure](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%9D%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0%D0%9E%D0%A1%D0%B4%D0%BB%D1%8F%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D1%8B%D1%812%D0%A4%D0%90) с доменными параметрами.

Для корректной работы доменной 2ФА необходимо, чтобы время на ПК совпадало с серверным.

Для настройки 2ФА:

1. Подключите токен к компьютеру.
2. Для настройки доменной 2ФА по сертификату:
1. [Создайте запрос на получение сертификата](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%A1%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5%D0%B7%D0%B0%D0%BF%D1%80%D0%BE%D1%81%D0%B0%D0%BD%D0%B0%D0%BF%D0%BE%D0%BB%D1%83%D1%87%D0%B5%D0%BD%D0%B8%D0%B5%D1%81%D0%B5%D1%80%D1%82%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%82%D0%B0,%D0%B3%D0%B5%D0%BD%D0%B5%D1%80%D0%B0%D1%86%D0%B8%D1%8F%D1%81%D0%B0%D0%BC%D0%BE%D0%BF%D0%BE%D0%B4%D0%BF%D0%B8%D1%81%D0%B0%D0%BD%D0%BD%D0%BE%D0%B3%D0%BE%D1%81%D0%B5%D1%80%D1%82%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%82%D0%B0).
2. [Получите сертификат УЗ от УЦ](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%9F%D0%BE%D0%BB%D1%83%D1%87%D0%B5%D0%BD%D0%B8%D0%B5%D1%81%D0%B5%D1%80%D1%82%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%82%D0%B0%D0%A3%D0%97%D0%BE%D1%82%D0%A3%D0%A6).
3. Для настройки локальной 2ФА по сертификату –[сгенерируйте самоподписанный сертификат](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%A1%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5%D0%B7%D0%B0%D0%BF%D1%80%D0%BE%D1%81%D0%B0%D0%BD%D0%B0%D0%BF%D0%BE%D0%BB%D1%83%D1%87%D0%B5%D0%BD%D0%B8%D0%B5%D1%81%D0%B5%D1%80%D1%82%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%82%D0%B0,%D0%B3%D0%B5%D0%BD%D0%B5%D1%80%D0%B0%D1%86%D0%B8%D1%8F%D1%81%D0%B0%D0%BC%D0%BE%D0%BF%D0%BE%D0%B4%D0%BF%D0%B8%D1%81%D0%B0%D0%BD%D0%BD%D0%BE%D0%B3%D0%BE%D1%81%D0%B5%D1%80%D1%82%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%82%D0%B0).

4. Введите в терминале команду:

[?](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#)

|     |
| --- |
| `sudo rtlogon-cli setup-auth [command parameters]` |

При помощи команды `rtlogon-cli setup-auth` можно настраивать 2ФА для другого ПК (с указанием соответствующего домена). В этом случае команда вводится без `sudo`.

**Command parameters**

| Параметр | Описание | Значение по умолчанию | Наличие параметра в команде | Условия применения |
| **Общие параметры** |
| ```<br>-l arg<br>```<br>```<br>или<br>```<br>```<br>--login arg<br>``` | Логин УЗ, для которой настраивается 2ФА | - | Обязательно |  |
| ```<br>-d arg<br>```<br>```<br>или<br>```<br>```<br>--domain arg<br>``` | Имя домена, в котором зарегистрирована УЗ | - | Опционально | Для доменных УЗ |
| ```<br>--disconnect-policy arg<br>``` | Политика ОС при отключении токена от ПК.<br>Возможные значения:<br>- **lock** – вызов экрана блокировки;<br>- **none** – продолжение текущей сессии | lock | Опционально | Необходимо отключить вызов экрана блокировки при отключении токена от ПК |
| ```<br>--token-id arg<br>или<br>-t arg<br>``` | Идентификатор токена, к которому применяется команда.<br>Как правило, идентификатор токена – это его серийный номер. Для некоторых моделей (комбинированные устройства JaCarta-2 PKI/ГОСТ и т.п.) – это серийный номер и постфикс, обозначающий апплет (-PKI/-GOST и т.п.).<br>Для просмотра информации об идентификаторе токена необходимо вызвать команду<br>[rtlogon-cli info](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%97%D0%B0%D0%BF%D1%80%D0%BE%D1%81%D0%B8%D0%BD%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%86%D0%B8%D0%B8%D0%BE%D0%BA%D0%BE%D0%BD%D1%84%D0%B8%D0%B3%D1%83%D1%80%D0%B0%D1%86%D0%B8%D0%B8rtlogon%D0%B8%D0%BF%D0%B0%D1%80%D0%B0%D0%BC%D0%B5%D1%82%D1%80%D0%B0%D1%85%D0%BB%D0%BE%D0%BA%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D0%B92%D0%A4%D0%90) | - | Опционально | К ПК подключено несколько токенов или один комбинированный токен |
| ```<br>-p arg<br>или<br>--pin arg<br>``` | PIN-код токена, к которому применяется команда.<br>При вводе PIN-код отображается в явном виде | - | Опционально | Необходимо явно указать PIN-код токена.<br>Если не указать параметр, после ввода команды в терминале появится запрос на ввод PIN-кода.<br>При вводе PIN-код не отображается |
| **Параметры настройки 2ФА по сложному паролю** |
| ```<br>--passwd<br>``` | Признак настройки 2ФА по сложному паролю | - | Обязательно |  |
| ```<br>-e arg<br>```<br>```<br>или<br>```<br>```<br>--expire-days arg<br>``` | Количество дней до перегенерации сложного пароля | - | Опционально | Необходимо задать количество дней до перегенерации сложного пароля.<br>Если параметр не указан, перегенерация сложного пароля не выполняется |
| ```<br>--domain-admin arg<br>``` | Логин администратора | - | Опционально | Настройка доменной 2ФА по сложному паролю.<br>Указание учетной записи администратора используется для изменения пароля пользователя на контроллере домена |
| **Параметры настройки 2ФА по сертификату** |
| ```<br>-c arg<br>```<br>```<br>или<br>```<br>```<br>--cert arg<br>``` | Путь к сертификату УЗ.<br>В случае когда сертификат располагается в текущей директории, допускается указывать только его наименование.<br>Поддерживаются следующие форматы сертификата:<br>- pem;<br>- der | - | Обязательно |  |
| ```<br>--login-policy arg<br>``` | Политика входа в ОС.<br>Возможные значения:<br>- **certonly** – только по сертификату и наличию подключенного токена;<br>- **certandpass** – по сертификату и наличию подключенного токена или по логину/паролю УЗ. Выбор осуществляется при входе в ОС.<br>Для администратора может быть установлен только **certandpass** | certonly | Опционально | Настройка локальной 2ФА по сертификату.<br>Необходимо изменить политику входа в ОС |

Рекомендуется перезагрузить ПК после выполнения команды для смены политики ОС при отключении токена от ПК.

**Пример**:

**Local certificate 2FA**

[?](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#)

|     |
| --- |
| `sudo rtlogon-cli setup-auth --login user2 --cert cert.pem --disconnect-policy lock --login-policy certonly`<br>`// Login is only by certificate 2FA; OS policy when token and PC are disconnected is block session`<br>`sudo rtlogon-cli setup-auth -l user -c cert.pem --disconnect-policy none --login-policy certandpass`<br>`// Login is by account login/password or certificate 2FA` |

**Local strong password 2FA**

[?](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#)

|     |
| --- |
| `sudo rtlogon-cli setup-auth --login user2 --passwd --disconnect-policy none` |

**Domain certificate 2FA**

[?](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#)

|     |
| --- |
| `rtlogon-cli setup-auth -c cert.pem --domain``"$DOMAIN"``--login``"$DOMAIN_USER"` |

**Domain strong password 2FA**

[?](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#)

|     |
| --- |
| `rtlogon-cli setup-auth --domain``"$DOMAIN"``--login``"$DOMAIN_USER"``--passwd -p``12341234`<br>`// enter domain admin login and password`<br>`rtlogon-cli setup-auth --domain``"$DOMAIN"``--login``"$DOMAIN_USER"``--passwd -p``12341234`<br>`--domain-admin``"$DOMAIN_ADMIN"`<br>`// enter domain admin password` |

## Проверка настройки 2ФА

Для проверки настроек 2ФА:

1. Завершите текущую сессию.
2. Убедитесь, что ключевой носитель подключен к ПК. В противном случае подключите ключевой носитель к ПК.
3. На **экране приветствия rtlogon**:
1. Выберите в списке устройств необходимый ключевой носитель.
2. В раскрывающемся списке **Логин** выберите логин необходимой УЗ.
3. Введите PIN-код в поле **PIN-код**.
4. Нажмите **Продолжить**.

      ![](https://dev.rutoken.ru/download/attachments/226459656/Logon%20enter.png?version=1&modificationDate=1765439022000&api=v2)
4. На **системном экране приветствия**:
1. Введите логин УЗ.
2. Введите PIN-код.

Если 2ФА была настроена корректно, будет выполнен успешный вход в систему.

## Изменение настроек 2ФА

Для изменения настроек 2ФА необходимо снова вызвать команду [rtlogon-cli setup-auth](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%9D%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B02%D0%A4%D0%90) с указанием нужным параметров.

## Удаление 2ФА

Перед удалением доменной 2ФА ОС должна быть сконфигурирована для работы с этим типом аутентификации, т.е. должна быть выполнена команда [rtlogon-cli configure](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%9D%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0%D0%9E%D0%A1%D0%B4%D0%BB%D1%8F%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D1%8B%D1%812%D0%A4%D0%90) с доменными параметрами.

Для удаления 2ФА:

1. Если требуется удалить 2ФА для УЗ только с токена или с токена и ПК – подключите токен к ПК. В противном случае данный пункт пропустить.

2. Введите в терминале команду:









[?](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#)



|     |
| --- |
| `sudo rtlogon-cli unsetup-auth [command parameters]` |

3. Введите PIN-код токена (если 2ФА удаляется с него).
4. При запросе дважды введите новый пароль для УЗ (если для 2ФА использовался сложный пароль).

При помощи команды `rtlogon-cli unsetup-auth` можно удалить 2ФА для УЗ другого ПК (при помощи указания домена или идентификатора ПК). В этом случае команда вводится без `sudo`.

**Command parameters**

| Параметр | Описание | Значение по умолчанию | Наличие параметра в команде | Условие применения |
| --- | --- | --- | --- | --- |
| ```<br>-l arg<br>или<br>--login arg<br>``` | Логин УЗ, для которой удаляется 2ФА | - | Обязательно |  |
| ```<br>-d arg<br>```<br>```<br>или<br>```<br>```<br>--domain arg<br>``` | Имя домена, в котором зарегистрирована УЗ | - | Опционально | Для доменных УЗ |
| ```<br>--host-id arg<br>``` | Идентификатор ПК, к которому привязана УЗ | - | Опционально | Удаление 2ФА для УЗ, привязанной к другому ПК с идентификатором _host-id._<br>В этом случае записи об УЗ с настроенной 2ФА удаляются только с токена.<br>Необходимо также указать параметр <br>--only-on-token |
| ```<br>--token-id arg<br>или<br>-t arg<br>``` | Идентификатор токена, к которому применяется команда.<br>Как правило, идентификатор токена – это его серийный номер. Для некоторых моделей (комбинированные устройства JaCarta-2 PKI/ГОСТ и т.п.) – это серийный номер и постфикс, обозначающий апплет (-PKI/-GOST и т.п.).<br>Для просмотра информации об идентификаторе токена необходимо вызвать команду [rtlogon-cli info](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%97%D0%B0%D0%BF%D1%80%D0%BE%D1%81%D0%B8%D0%BD%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%86%D0%B8%D0%B8%D0%BE%D0%BA%D0%BE%D0%BD%D1%84%D0%B8%D0%B3%D1%83%D1%80%D0%B0%D1%86%D0%B8%D0%B8rtlogon%D0%B8%D0%BF%D0%B0%D1%80%D0%B0%D0%BC%D0%B5%D1%82%D1%80%D0%B0%D1%85%D0%BB%D0%BE%D0%BA%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D0%B92%D0%A4%D0%90) | - | Опционально | К ПК подключено несколько токенов или один комбинированный токен |
| ```<br>-p arg<br>```<br>```<br>или<br>```<br>```<br>--pin arg<br>``` | PIN-код токена, к которому применяется команда.<br>При вводе PIN-код отображается в явном виде | - | Опционально | Необходимо явно указать PIN-код токена.<br>Если не указать параметр, после ввода команды в терминале появится запрос на ввод PIN-кода.<br>При вводе PIN-код не отображается |
| ```<br>--ignore-token<br>``` | Удалить 2ФА для УЗ только с ПК.<br>На токене 2ФА для УЗ сохраняется | - | Опционально | Для локальных УЗ |
| ```<br>--keep-cert-and-key<br>``` | Удалить 2ФА для УЗ с ПК и токена с сохранением ключевой пары и сертификата | - | Опционально | Удаление 2ФА для УЗ с ПК и токена с сохранением ключевой пары и сертификата |
| ```<br>--only-on-token<br>``` | Удалить 2ФА для УЗ только с токена.<br>На ПК 2ФА для УЗ сохраняется | - | Опционально | Удаление 2ФА для УЗ только с токена |
| ```<br>--domain-admin arg<br>``` | Логин администратора | - | Опционально | Удаление доменной 2ФА по сложному паролю для УЗ |

Если вызвать команду `rtlogon-cli unsetup-auth` без следующих параметров, то 2ФА для УЗ удаляется и с токена, и с ПК:

- `--ignore-token;`

- `--keep-cert-and-key;`

- `--only-on-token.`


Ключевая пара и сертификат при этом не сохраняются.

**Пример**:

**Remove local 2FA**

[?](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#)

|     |
| --- |
| `sudo rtlogon-cli unsetup-auth -l``"$LOCAL_USER"``--pin <PIN-code>` |

**Remove domain 2FA**

[?](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#)

|     |
| --- |
| `rtlogon-cli unsetup-auth -l``"$DOMAIN_CERT_USER"``-d``"$DOMAIN"``--pin <PIN-code>`<br>`rtlogon-cli unsetup-auth -l``"$DOMAIN_PASSWD_USER"``-d``"$DOMAIN"``--pin <PIN-code>`<br>`// enter domain admin login and password`<br>`rtlogon-cli unsetup-auth -l``"$DOMAIN_PASSWD_USER"``-d``"$DOMAIN"``--pin <PIN-code>`<br>`--domain-admin``"$DOMAIN_ADMIN"`<br>`// enter domain admin password` |

**Remove local 2FA for other PC**

[?](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#)

|     |
| --- |
| `rtlogon-cli unsetup-auth -l``"$LOCAL_USER"``--host-id``"$HOST_ID"``--pin <PIN-code>` |

**Remove domain 2FA with key pair and certificate saved**

[?](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#)

|     |
| --- |
| `rtlogon-cli unsetup-auth -l``"$DOMAIN_USER"``-d``"$DOMAIN"``--keep-cert-and-key --pin <PIN-code>` |

## Кеширование УЗ

В rtlogon для sssd по умолчанию включена функция кеширования УЗ с настроенной доменной 2ФА (по сертификату или сложному паролю).

Кеширование доменных УЗ позволяет пользователям аутентифицироваться в свою УЗ даже при отсутствии соединения с КД.

Кеширование задается следующими параметрами:

[?](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#)

|     |
| --- |
| `[sssd]`<br>`certificate_verification = soft_ocsp, soft_crl, ...`<br>`# вместо <domain_name> указывается имя домена`<br>`[domain/<domain_name>]`<br>`cache_credentials = True`<br>`krb5_store_password_if_offline = True` |

Чтобы отключить кеширование УЗ, введите в терминале следующие команды:

[?](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#)

|     |
| --- |
| `mkdir -p /etc/sssd/conf.d/`<br>`cat >> /etc/sssd/conf.d/``60``-disable_offile_auth.conf <<EOF`<br>`[sssd]`<br>`certificate_verification =`<br>`# вместо <domain_name> указывается имя домена`<br>`[domain/<domain_name>]`<br>`cache_credentials = False`<br>`krb5_store_password_if_offline = False`<br>`EOF`<br>`chown root:root /etc/sssd/conf.d/``60``-disable_offile_auth.conf`<br>`chmod``600``/etc/sssd/conf.d/``60``-disable_offile_auth.conf`<br>`systemctl restart sssd` |

## Создание запроса на получение сертификата, генерация самоподписанного сертификата

Чтобы создать запрос на получение сертификата или сгенерировать самоподписанный сертификат:

1. Подключите токен к ПК.
2. Введите в терминале команду:

[?](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#)

|     |
| --- |
| `rtlogon-cli create-cert [certificate parameters] [token parameters] [certificate content]` |

**Command parameters**

| Параметр | Описание | Значение по умолчанию | Наличие параметра в команде | Условие применения |
| **Certificate parameters** |
| ```<br>-a arg<br>```<br>```<br>или<br>```<br>```<br>--alg arg<br>``` | Криптоалгоритм создания сертификата.<br>Доступные значения:<br>- rsa;<br>- gost256;<br>- gost512 | rsa c длиной ключа 2048 | Опционально | Необходимо изменить криптоалгоритм с rsa на другой доступный.<br>Домены поддерживают работу только с криптоалгоритмом RSA |
| ```<br>-s <br>```<br>```<br>или<br>```<br>```<br>--self-signed<br>``` | Признак генерации самоподписанного сертификата | - | Опционально | Генерация самоподписанного сертификата |
| ```<br>-o arg<br>или<br>--output arg<br>``` | Путь к сохраняемому на ПК сертификату. <br>В случае, если сертификат будет располагаться в текущей директории, допускается указывать только его наименование | - | Обязательно |  |
| **Token parameters** |
| ```<br>-t arg<br>или<br>--token-id arg<br>``` | Идентификатор токена, к которому применяется команда.<br>Как правило, идентификатор токена – это его серийный номер. Для некоторых моделей (комбинированные устройства JaCarta-2 PKI/ГОСТ и т.п.) – это серийный номер и постфикс, обозначающий апплет (-PKI/-GOST и т.п.).<br>Для просмотра информации об идентификаторе токена необходимо вызвать команду [rtlogon-cli info](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%97%D0%B0%D0%BF%D1%80%D0%BE%D1%81%D0%B8%D0%BD%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%86%D0%B8%D0%B8%D0%BE%D0%BA%D0%BE%D0%BD%D1%84%D0%B8%D0%B3%D1%83%D1%80%D0%B0%D1%86%D0%B8%D0%B8rtlogon%D0%B8%D0%BF%D0%B0%D1%80%D0%B0%D0%BC%D0%B5%D1%82%D1%80%D0%B0%D1%85%D0%BB%D0%BE%D0%BA%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D0%B92%D0%A4%D0%90) | - | Опционально | Если к ПК подключено несколько токенов или один комбинированный токен |
| ```<br>-p arg<br>или<br>--pin arg<br>``` | PIN-код токена, к которому применяется команда.<br>При вводе PIN-код отображается в явном виде | - | Опционально | Необходимо явно указать PIN-код токена.<br>Если не указать параметр, после ввода команды в терминале появится запрос на ввод PIN-кода.<br>При вводе PIN-код не отображается |
| **Certificate content** |
| ```<br>--dn CN arg<br>``` | Common Name (CN) субъекта сертификата (имя пользователя).<br>Конкретный формат имени пользователя зависит от настроек домена.  Если имя пользователя будет указано в неверном формате, то при аутентификации сертификат не будет найден | - | Обязательно |  |
| ```<br>--dn C arg<br>``` | Страна.<br>Для обозначения используется двухбуквенный код страны в соответствии с ISO 3166 | RU | Опционально | Необходимо изменить название страны |
| ```<br>--dn ST arg<br>``` | Область (край и т.д.).<br>Указывается одним словом.<br>Используемый алфавит: латинский | - | Опционально | Необходимо указать название области |
| ```<br>--dn STREET arg<br>``` | Улица.<br>Указывается одним словом.<br>Используемый алфавит: латинский | - | Опционально | Необходимо указать название улицы |
| ```<br>--dn L arg<br>``` | Город.<br>Указывается одним словом.<br>Используемый алфавит: латинский | - | Опционально | Необходимо указать название города |
| ```<br>--dn O arg<br>``` | Название организации.<br>Указывается одним словом.<br>Используемый алфавит: латинский | - | Опционально | Необходимо указать название организации |
| ```<br>--days arg<br>``` | Время действия сертификата (в днях).<br>Максимальное значение: **5500 дней**.<br>Датой начала действия сертификата является дата выполнения команды `create-cert` | 1095 дней (3 года) | Опционально | Для самоподписанного сертификата.<br>Необходимо изменить срок его действия |

**Пример:**

**Create self-signed certificate**

[?](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#)

|     |
| --- |
| `rtlogon-cli create-cert -s -o cert.pem -p``12345678``--dn CN Petrova --dn C BB --dn ST Lilovaja --dn L Saratov --dn O Pulse --days``365` |

**Create a request for a certificate**

[?](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#)

|     |
| --- |
| `rtlogon-cli create-cert -a gost256 -o cert.pem -p``12345678``--dn CN Petrova --dn C BB` |

**Request file content**

[?](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#)

|     |
| --- |
| `-----BEGIN CERTIFICATE-----`<br>`MIIEsDCCApgCAQAwDQYJKoZIhvcNAQELBQAwHjEPMA0GA1UEAwwGYWxkcHJvMQsw`<br>`CQYDVQQGEwJSVTAeFw0yNDA5MDkxNDQ5NTRaFw0yNzA5MDkxNDQ5NTRaMB4xDzAN`<br>`BgNVBAMMBmFsZHBybzELMAkGA1UEBhMCUlUwggIiMA0GCSqGSIb3DQEBAQUAA4IC`<br>`DwAwggIKAoICAQDHGEBEgZXouPLusCh80U/r8c5q0gNSzV83GzJJRJlzo5fcUK7p`<br>`eNzTx2dPQL6moUrLQrpgAiFW08ZsI42S4QAg8A8+AL58nNnrdmCbahcj8LPvY9uZ`<br>`u3SVO8bts4PfH6kqk9xgX5LVOrXvFw2k4a+A+7h+n/9fWDy1aRv+8Au9whN6XRaj`<br>`Mr6a4HzF22ohpxwRRL8HVWA33Kxrpvt3OsnG7Tw50tpNXyKljpQRoIJJSwsZ0Kwn`<br>`+6kIAh2T6L6odQmToA/cJi5IjHcuRx7Pef3qOqHj0CiojARY24Hkx7p8SsYddfvx`<br>`D8TN6gov1/FJ7QJNqkPkYr6bCr6jAoS6XzP8VoMV7fTj3JUONJRqrdVL4imR7jwE`<br>`qcMV1uLFi8W2d3eIesr0jpTAWLT19ObK7gH61HR10NQIgrrYGdRnV04ZKq8b4R13`<br>`bI6c0/Aq/c7MiB1TIF5nT4NG8zio7u3xTdyRELZb6As5eqTRWpI0wMdQvhtbLmtQ`<br>`XbFR9CEQmZhAllP4CTvCN/bAEIA6BpHJdq8dXVPOYHQ7OCFmvOLEDvrBjQiPdhbZ`<br>`p1Lr4sFrrPrj4vEA/Fz7z0KmlN8wGZIxBrPRvCGeuBF5A8bgxhOMubZJibEagt2+`<br>`m4QC6Zo5KJRszVWgiR9qnWr+bV3wPPNvbbQvJchSy8bAAstvrz06VIJt6QIDAQAB`<br>`MA0GCSqGSIb3DQEBCwUAA4ICAQBLI8Jx0+z+vfyPUIdnCrOPubp7XiWw76pXQIno`<br>`B9suGdXkHytahq0am7+9A3E3rmgyNh8tvOkSmkmCM2cMMreeHW1pSiQp58J5tEiT`<br>`uZGpplAp+FQpFRYqQQ7Ibzhmi2sb5qQ2C01q+``2``+QGEmySxKIt+idLhmP+Hf2xK+m`<br>`1D9vqQLdJ5WlTqpvscxNI9ybSwl8qtM0qs9xWbRP+M9G0FGrvZR2pYhVzQYOYVWh`<br>`V6wRDxMDzgKeh3vzOdcIi22b06FxA1DQ5qI6xIuE0JmGiplPzgK0TKCnr8YFSQ9W`<br>`fjA+Unfu+rED1kf/j3a2ErmqdAvfYAlgyNJNluq9O7NGMzMolzJr0KmGSOQESXW0`<br>`9ohhxxQdl8cOg/zqZWbvxjv5WaELsblVEF0dS1wFetva0PVCSuA3eITX/loWvhZR`<br>`n7spWnYfkpVMgwYKrAofAc/2h0N88v2XvetnA0YvYOLxeolHt1FWvLWsdkiD1Wk+`<br>`3yXuNsFvA+s/uzO/HchGMvF7QlIeWhdwsriGgGbjpjn5VMIknLvykJbC07X1fZmo`<br>`pWe4wEkG5h7FTZ1omYwbNvbfdFgTudmaSnTiydNxjFND0pekVqRPCu7XDuV4BexE`<br>`3qeL3619OtSCznEfhfZvPfu2unEBi1NkRQ/Gmqt00KmIDKcAwjgwxKU1IZ68OlYO`<br>`qR4Lxg==`<br>`-----END CERTIFICATE-----` |

## Получение сертификата УЗ от УЦ

### FreeIPA и ALDPro

После создания запроса на получение сертификата введите в терминале следующие команды:

[?](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#)

|     |
| --- |
| `kinit [admin login]`<br>`ipa cert-request [the path to the certificate request file] --principal [domain account login``for``which certificate is being issued] --ca [certification center type] --profile-id [certification center ID profile] --certificate-out [certificate name]`<br>`kdestroy` |

При запросе введите пароль администратора.

**Пример.**

[?](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#)

|     |
| --- |
| `kinit admin`<br>`ipa cert-request ./cert.req --principal user3 --ca ipa --profile-id caIPAserviceCert --certificate-out cert.pem`<br>`kdestroy` |

### Active Directory

После создания запроса на получение сертификата:

1. Зайдите на веб-интерфейс УЦ КД. По умолчанию адрес имеет следующий вид:

_https://\[domain\]/certsrv._
2. Авторизуйтесь под УЗ, для которой запрашивается сертификат.

![](https://dev.rutoken.ru/download/attachments/226459656/AD_cert_UZ_1.png?version=1&modificationDate=1765439588000&api=v2)

3. Выберите задачу **Request a certificate**.

![](https://dev.rutoken.ru/download/attachments/226459656/AD_cert_UZ_2.png?version=1&modificationDate=1765439638000&api=v2)

4. Выберите пункт **advanced certificate request**.

![](https://dev.rutoken.ru/download/attachments/226459656/AD_cert_UZ_3.png?version=1&modificationDate=1765439677000&api=v2)

5. Вставьте в поле **Saved Request** содержимое файла запроса сертификата (включая надписи BEGIN CERTIFICATE, END CERTIFICATE).
6. Выберите в качестве шаблона **User**.
7. Нажмите **Submit**.

![](https://dev.rutoken.ru/download/attachments/226459656/AD_cert_UZ_4.png?version=1&modificationDate=1765439718000&api=v2)
8. В поле Certificate Issued выберите **Base 64 encoded** и нажмите **Download certificate**. Загрузка сертификата УЗ на ПК начнется автоматически.


### Samba DC

После создания запроса на на получение сертификата:

1. Отправьте запрос на УЦ.

Форма и способ отправки запроса зависят от выбранного и настроенного администратором УЦ.
2. Подпишите запрос на стороне УЦ.

Способ подписания зависит от заданных администратором настроек УЦ.
3. Скопируйте подписанный сертификат УЗ на ПК.

## Смена PIN-кода токена

rtlogon поддерживает возможность смены PIN-кода токена, заданного по умолчанию.

Сменить PIN-код можно при первичном входе в ОС, или его может сменить администратор.

Для смены PIN-кода администратором:

1. Подключите токен к ПК.
2. Введите в терминале команду:









[?](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#)



|     |
| --- |
| `rtlogon-cli change-pin [token parameters]` |

3. Введите текущий PIN-код токена.
4. Введите дважды новый PIN-код токена.

**Token parameters**

| Параметр | Описание | Значение по умолчанию | Наличие параметра в команде | Условие применения |
| --- | --- | --- | --- | --- |
| ```<br>--token-id arg<br>или<br>-t arg<br>``` | Идентификатор токена, к которому применяется команда.<br>Как правило, идентификатор токена – это его серийный номер. Для некоторых моделей (комбинированные устройства JaCarta-2 PKI/ГОСТ и т.п.) – это серийный номер и постфикс, обозначающий апплет (-PKI/-GOST и т.п.).<br>Для просмотра информации об идентификаторе токена необходимо вызвать команду [rtlogon-cli info](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#id-%D0%A0%D1%83%D1%82%D0%BE%D0%BA%D0%B5%D0%BD%D0%9B%D0%BE%D0%B3%D0%BE%D0%BD%D0%B4%D0%BB%D1%8FLinux.%D0%92%D0%B5%D1%80%D1%81%D0%B8%D1%8F1.0.0.%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0-%D0%97%D0%B0%D0%BF%D1%80%D0%BE%D1%81%D0%B8%D0%BD%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%86%D0%B8%D0%B8%D0%BE%D0%BA%D0%BE%D0%BD%D1%84%D0%B8%D0%B3%D1%83%D1%80%D0%B0%D1%86%D0%B8%D0%B8rtlogon%D0%B8%D0%BF%D0%B0%D1%80%D0%B0%D0%BC%D0%B5%D1%82%D1%80%D0%B0%D1%85%D0%BB%D0%BE%D0%BA%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D0%B92%D0%A4%D0%90) | - | Опционально | Если к ПК подключено несколько токенов или один комбинированный токен |

**Пример:**

**User PIN code changing for one connected token**

[?](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#)

|     |
| --- |
| `rtlogon-cli change-pin`<br>`Enter token (3f2a50b2) PIN-code:`<br>`Enter``new``PIN-code:`<br>`Repeat``new``PIN-code:`<br>`PIN-code changed succesfully` |

**User PIN code changing for several connected tokens**

[?](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#)

|     |
| --- |
| `rtlogon-cli change-pin --token-id 3f2a50b2`<br>`Enter token (3f2a50b2) PIN-code:`<br>`Enter``new``PIN-code:`<br>`Repeat``new``PIN-code:`<br>`PIN-code changed succesfully` |

## Разблокировка PIN-кода на экране приветствия или блокировки

rtlogon поддерживает разблокировку PIN-кода токена на экране приветствия только при использовании GUI rtlogon.

Разблокировка PIN-кода не поддерживается на ключевых носителях JaCarta ГОСТ. Чтобы разблокировать эти устройства, необходимо обратиться к их производителю.

Чтобы выполнить разблокировку:

1. Введите PIN-код Администратора токена в поле **PIN-код Администратора**.
2. Нажмите **Продолжить**.

![](https://dev.rutoken.ru/download/attachments/226459656/%D0%A0%D0%B0%D0%B7%D0%BB%D0%BE%D0%BA%D0%B8%D1%80%D0%BE%D0%B2%D0%BA%D0%B0%20PIN_4.png?version=1&modificationDate=1765439910000&api=v2)

3. Введите новый PIN-код в поле **Новый PIN-код**.





Администратор может ввести для токена PIN-код по умолчанию (например, для Рутокена – 12345678). В этом случае при последующем входе в систему rtlogon попросит пользователя сменить PIN-код по умолчанию на другой.

4. Продублируйте новый PIN-код в поле **Повторите новый PIN-код**.
5. Нажмите **Разблокировать**.

![](https://dev.rutoken.ru/download/attachments/226459656/%D0%A0%D0%B0%D0%B7%D0%BB%D0%BE%D0%BA%D0%B8%D1%80%D0%BE%D0%B2%D0%BA%D0%B0%20PIN_2.png?version=1&modificationDate=1765439956000&api=v2)

6. Получите на экране сообщение о том, что PIN-код разблокирован.

![](https://dev.rutoken.ru/download/attachments/226459656/%D0%A0%D0%B0%D0%B7%D0%BB%D0%BE%D0%BA%D0%B8%D1%80%D0%BE%D0%B2%D0%BA%D0%B0%20PIN_3.png?version=1&modificationDate=1765439991000&api=v2)

7. Повторите вход в систему с новым PIN-кодом.

## Запрос информации о конфигурации rtlogon и параметрах локальной 2ФА

rtlogon поддерживает вывод в терминале данных о своей конфигурации и о настроенной 2ФА.

Для получения данных:

1. Подключите токен к ПК (если необходимо вывести данные о 2ФА, хранящиеся на токене).
2. Введите в терминале команду:

[?](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#)

|     |
| --- |
| `rtlogon-cli info [command parameter]` |

**Command parameter**

| Параметр | Описание | Значение по умолчанию | Наличие параметра в команде | Условие применения |
| --- | --- | --- | --- | --- |
| ```<br>-v <br>или<br>--verbose<br>``` | Вывод расширенного набора данных. | - | Опционально | Необходимо получить расширенный набор данных |

Выводимые данные делятся на:

- стандартный набор;
- расширенный набор.

Стандартный набор данных содержит:

- информацию о библиотеке:
  - pkcs11 Rutoken (librtpkcs11ecp);
  - pkcs11 JaCarta (libjcPKCS11-2).
- идентификатор ПК;
- список локальных 2ФА, настроенных на ПК, содержащий:
  - логин УЗ;
  - идентификатор (серийный номер) токена;
  - идентификатор секрета (сложного пароля или сертификата) на токене;
  - тип настроенной локальной 2ФА – 2ФА по сертификату или 2ФА по сложному паролю;
  - политику входа в ОС для локальной 2ФА по сертификату.
- список подключенных к ПК токенов, содержащий:
  - логин УЗ;
  - идентификатор ПК – для настроенной локальной 2ФА или имя домена – для настроенной доменной 2ФА;
  - тип секрета, используемого для 2ФА;
  - политику ОС при отключении токена от ПК.

Расширенный набор данных содержит:

- стандартный набор;
- тип используемого КД – для доменной конфигурации ОС;
- тип используемых экранов приветствия и блокировки (системные или rtlogon);
- данные по сертификатам пользователя:
  - идентификатор сертификата на токене;
  - период действия сертификата;
  - метка сертификата;
  - Distinguished name (DN) субъекта;
  - УЦ, выдавший сертификат;
  - содержимое сертификата.
- информацию о корневом сертификате и сертификатах промежуточных УЦ, составляющих цепочку доверия:
  - УЦ, выдавший сертификат;
  - содержимое сертификата;
  - период действия сертификата;
  - Distinguished name (DN) субъекта.
- метка сложного пароля – для 2ФА по сложному паролю.

**Пример:**

[?](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#)

|     |
| --- |
| `//Standard information`<br>`rtlogon-cli info`<br>`PKCS#``11``libraries info:`<br>```Rutoken pkcs11 library:`<br>```Cryptoki``interface``version:``2.40`<br>```Cryptoki library version:``2.14`<br>```Manufacturer: Aktiv Co.`<br>```Library description: Rutoken ECP PKCS #``11``library`<br>```JaCarta pkcs11 library:`<br>```Not found (valid library must be version no lower than``2.8``).`<br>`Rtlogon configuration:`<br>```Host id:``479``-``485``-``859``-``343`<br>`Local users with configured rtlogon 2FA:`<br>```Not found`<br>`Tokens info:`<br>```Token #``0``(id:``0986078429``)`<br>```Record #``0`<br>```User: kek`<br>```Host id:``992``-``600``-``966``-``077`<br>```Auth type: strong password`<br>```Disconnection type: lock`<br>```Record #``1`<br>```User: kek`<br>```Domain: rtkn.test`<br>```Auth type: certificate`<br>```Disconnection type: lock` |

[?](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#)

|     |
| --- |
| `//Extended information`<br>`rtlogon-cli info -v`<br>`PKCS#``11``libraries info:`<br>```Rutoken pkcs11 library:`<br>```Cryptoki``interface``version:``2.40`<br>```Cryptoki library version:``2.14`<br>```Manufacturer: Aktiv Co.`<br>```Library description: Rutoken ECP PKCS #``11``library`<br>```JaCarta pkcs11 library:`<br>```Not found (valid library must be version no lower than``2.8``).`<br>`Rtlogon configuration:`<br>```Host id:``479``-``485``-``859``-``343`<br>```System gui:``false`<br>```Domain type: ipa`<br>```CA certificates chain:`<br>```Certificate #``0`<br>```Validity starts:``2023``-``09``-``07``12``:``13``:``53`<br>```Validity ends:``2043``-``09``-``07``12``:``13``:``53`<br>```Subject: O=RTKN.TEST CN=Certificate Authority`<br>```Issuer: O=RTKN.TEST CN=Certificate Authority`<br>```Cert body:`<br>```-----BEGIN CERTIFICATE-----`<br>```MIIEhTCCAu2gAwIBAgIBATANBgkqhkiG9w0BAQsFADA0MRIwEAYDVQQKDAlSVEtO`<br>```LlRFU1QxHjAcBgNVBAMMFUNlcnRpZmljYXRlIEF1dGhvcml0eTAeFw0yMzA5MDcw`<br>```OTEzNTNaFw00MzA5MDcwOTEzNTNaMDQxEjAQBgNVBAoMCVJUS04uVEVTVDEeMBwG`<br>```A1UEAwwVQ2VydGlmaWNhdGUgQXV0aG9yaXR5MIIBojANBgkqhkiG9w0BAQEFAAOC`<br>```AY8AMIIBigKCAYEAx8X2h3WrNd7bNmh1wMv52gVapipzdtcU/TNs+YzlB1hsj4Qd`<br>```XDG+``//DYqNT8vIi5FzyWHPDiH7ciXJIP75dWFXkaftVjcoiPUy0ipAGjfoKnNvaD`<br>```pPCm9dCB05V09iDxKyS+G35wm66lG8PZ5PDySi14/8g6+vHQM/whAa9nfLpimJf+`<br>```Sw6XZUJGIXyRN6fAO70Uybj/N28YYJds4q3hJjQdR/LFQrPUswoRpv/XPI8U6l+N`<br>```eV6gVuhjy5ZlnIS1HwfIoCLZekVtEuXqtzmJdydeUWhDV/OMcAAK8nRi8GFbEJAA`<br>```JTP8FO4uVEK2xHywjIAHofM+a8+nK37DuFKbM6fvptlrTQcurzW48+5lkWqzs2T9`<br>```1knZNAlG/oTelNMiGyshoYAnZbN4hiwSjBwlhdTtN3k5xwD+XTTdBVUNwpb0s1Ka`<br>```jHpdDAkUyltpGPWf1TOYn4ifyX8U/se6CHrZgjrl0bUb40YuHC/ZlW3d7rGvBR9K`<br>```QeIIYM6BE4yZlA67AgMBAAGjgaEwgZ4wHwYDVR0jBBgwFoAUaiJEAvkud9Dfyq4K`<br>```aRsWn4veWEgwDwYDVR0TAQH/BAUwAwEB/zAOBgNVHQ8BAf8EBAMCAcYwHQYDVR0O`<br>```BBYEFGoiRAL5LnfQ38quCmkbFp+L3lhIMDsGCCsGAQUFBwEBBC8wLTArBggrBgEF`<br>```BQcwAYYfaHR0cDovL2lwYS1jYS5ydGtuLnRlc3QvY2Evb2NzcDANBgkqhkiG9w0B`<br>```AQsFAAOCAYEAiCLzFlR2RhPc8IUcYs+5J4afP40tCaDHeZdfZdtpE0lsibSU1sLK`<br>```7QAdmePfxfZ2NX5b0WyL7p+K3gPFbM08dmFZoIBflz5m1Ew04p0z51w3ZvMtG/Ft`<br>```X8/sewfo76BHMBFTZUw5BXbgPuzuoTCI7iV0RwskEcKzyukqdvYA0G/X70sRgVS+`<br>```HkAcY+0PL3n0pfTmEu/j3xm3PpRT6QZPlF/vlJC26Kbf19iNHZxZyvVx1O6B9AYS`<br>```6XqZiFKs9KahnHr7ooHv7mgmbBqwnG3wvB7l9UU3JaR6y1aiQ5y3RWD5No1rqoQr`<br>```UnEkBuNmh8ZrTaD9eyD3CXyAaMhx6KwDliUTNrHG4UTmK33mN5sxmZ31DHQrIx7x`<br>```H/7OmEF+KCggz8lP+GdQewW/ZlaLMu1Djje3afxNKyNJ6Kr89YK0guXZCuaXZRN/`<br>```ZUtN7594FYFfUL2W28qbYGl9ftVSbbmAO88idSSBpsPmlPu0Iq58GKdmhwHZSYXs`<br>```tizXwJnH4MHb`<br>```-----END CERTIFICATE-----`<br>`Local users with configured rtlogon 2FA:`<br>```Not found`<br>`Tokens info:`<br>```Token #``0``(id:``0986078429``)`<br>```Record #``0`<br>```User: kek`<br>```Host id:``992``-``600``-``966``-``077`<br>```Auth type: strong password`<br>```Disconnection type: lock`<br>```Object id: 2a2abd17e6335dcc`<br>```Record #``1`<br>```User: kek`<br>```Domain: rtkn.test`<br>```Auth type: certificate`<br>```Disconnection type: lock`<br>```User's certificate:`<br>```Label: e1c22ddcc13a0a70`<br>```Object id: e1c22ddcc13a0a70`<br>```Validity starts:``2025``-``07``-``01``15``:``47``:``47`<br>```Validity ends:``2027``-``07``-``02``15``:``47``:``47`<br>```Subject: O=RTKN.TEST CN=kek`<br>```Issuer: O=RTKN.TEST CN=Certificate Authority`<br>```Cert body:`<br>```-----BEGIN CERTIFICATE-----`<br>```MIIEezCCAuOgAwIBAgIDARmgMA0GCSqGSIb3DQEBCwUAMDQxEjAQBgNVBAoMCVJU`<br>```S04uVEVTVDEeMBwGA1UEAwwVQ2VydGlmaWNhdGUgQXV0aG9yaXR5MB4XDTI1MDcw`<br>```MTEyNDc0N1oXDTI3MDcwMjEyNDc0N1owIjESMBAGA1UECgwJUlRLTi5URVNUMQww`<br>```CgYDVQQDDANrZWswggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDQkxZF`<br>```OnaeuAaLOaOubxEMBzaqw+iAHG5Zw5wtIOcwG7rAscZmo4oVEkAhzbrRyzWkzHM7`<br>```4dytlQLoD5gwnH/hoB9PPuoi/s01khvnGZC5eIMB3GG7NtVMxuPK0fPQ5A0wbAbJ`<br>```HAwOYDyCn6j0KgcI1J+xOcZWNLjlEQcrcf5HVxeywu+758IzooJ8MMLVlckvc6xW`<br>```9DqIoNF8Rf1OY4VybVqVvpIjNouQN15dJDxlrYzfPM9caILNrRInMZrSZzH+BZ6V`<br>```ho2wD+02uGxqAQPILGZ0al39oLm8GtSoMnNqKQ4CRHIOmj8yY9NTNEAAVmIbFA5U`<br>```s2SXFc067raOVrb/AgMBAAGjggEmMIIBIjAfBgNVHSMEGDAWgBRqIkQC+S530N/K`<br>```rgppGxafi95YSDA7BggrBgEFBQcBAQQvMC0wKwYIKwYBBQUHMAGGH2h0dHA6Ly9p`<br>```cGEtY2EucnRrbi50ZXN0L2NhL29jc3AwDgYDVR0PAQH/BAQDAgTwMB0GA1UdJQQW`<br>```MBQGCCsGAQUFBwMBBggrBgEFBQcDAjB0BgNVHR8EbTBrMGmgMaAvhi1odHRwOi8v`<br>```aXBhLWNhLnJ0a24udGVzdC9pcGEvY3JsL01hc3RlckNSTC5iaW6iNKQyMDAxDjAM`<br>```BgNVBAoMBWlwYWNhMR4wHAYDVQQDDBVDZXJ0aWZpY2F0ZSBBdXRob3JpdHkwHQYD`<br>```VR0OBBYEFMveJEKuO5IQRYWg00BP7ZQNbh27MA0GCSqGSIb3DQEBCwUAA4IBgQC0`<br>```MTnhyu9E/010QvIMMm4sZn2Xx7LlbZjIj2XEoVUHYIBSYcdV5EfM4Ypzy3HFKnjO`<br>```UfLJjLbyhBHA5gGODfJexjTuh/EZ00xMkyHkRYZbn2MLlFZWQsTnHM6r0fuhP6/t`<br>```ZgBbgOXAQrQDb7ZJNZ39Q7nboFC6mc6rvTrFuSR56sZpTvkg57EQ02aMyZgTDZV2`<br>```2cp9QhSyU6UblK4DTQo5MU4RJ3wo2/gins/m4wrRmUe2NuYZwBG6Ud6gWt6gnE5o`<br>```LosVsXSfAlw7p8GphyelBH4UWIT+CkpCwk4nJElJCkk4hHaYFTZ1JL3QYuIhXFtR`<br>```PD9a0rr8jD3re1lF4EN1nFijxEl+K3C9KwEoIQhj7JYDSbr3FjEa+kU98yLJO3zY`<br>```3qjnvUnEM0pQoroq+5NgoWJu93bt2eN8DCFCrkZOjp2d/07EFTbv4NdoJy2FX21b`<br>```4FkYFu4P31JlCdE4iyetgsF51qtSXHLtYlAa10V4EwgVuGcT2AGcp2E+fywlyGc=`<br>```-----END CERTIFICATE-----` |

## Логирование работы rtlogon

Записи о работе rtlogon сохраняются в лог-файл _/var/log/_ _rtlogon.log_ со следующими характеристиками:

- максимальный размер файла – 5 Мб;
- количество лог-файлов в директории хранения для обеспечения ротации – 5.

Ротацию лог-файлов обеспечивает внешняя утилита – logrotate.

Запись событий в лог-файл включена по умолчанию. Доступ к лог-файлу осуществляется по правам администратора.

В лог-файл записываются данные о следующих событиях безопасности:

- успешная/неуспешная аутентификация пользователя;
- перегенерация сложного пароля;
- изменение PIN-кода по умолчанию.

Эти данные дополнительно записываются в _sys_ _log_.

## Экспорт конфигурационных файлов, лог-файлов и файла с параметрами локальной 2ФА

1. Введите в терминале команду:









[?](https://dev.rutoken.ru/pages/viewpage.action?pageId=226459656#)



|     |
| --- |
| `sudo rtlogon-cli collect-log [command parameter]` |

2. При запросе введите пароль администратора.

**Command parameter**

| Параметр | Описание | Значение по умолчанию | Наличие параметра в команде | Условие применения |
| --- | --- | --- | --- | --- |
| `-o arg`<br>или <br>`--output arg` | Путь к выгружаемому архиву (содержит имя архива). <br>Имя выгружаемого архива определяет администратор.<br>Доступные расширения архива:<br>- tar.gz;<br>- tar.bz2;<br>- tar.xz;<br>- zip | - | Обязательно |  |

Выгруженный архив содержит следующие файлы:

- _state\_info.txt_ – со следующей информацией:
  - параметры конфигурации rtlogon;
  - данные об установленных библиотеках PKCS#11;
  - записи о настроенной локальной 2ФА;
  - записи о 2ФА, хранящиеся на токене;
  - сведения о подключенных к ПК токенах;
  - описание публичных объектов на токенах (объекты данных, сертификаты, публичные ключи);
  - сведения о корневом сертификате и промежуточных сертификатах УЦ, составляющих цепочку доверия.
- _os\_info.txt_ – файл с информацией о ядре ОС;
- _installed\_deb\_packages.txt_ или _installed\_rpm\_packages.txt_ – файл с информацией об установленном пакете;
- _journalctl.log_ – системный журнал, содержащий записи за последние 30 дней;
- лог-файлы:
  - _/var/log/audit/audit.log_ – журнал аудита системных событий;
  - _/var/log/auth.log_ или _/var/log/secure_ – лог-файл pam-модулей и pam-приложений;
  - _/var/log/fly-dm.log_ – лог-файл модуля fly-dm (для ОС Astra Linux);
  - _/var/log/rtlogon.log_ – лог-файл rtlogon;
  - _/var/log/messages_ – системный лог-файл;
  - _/var/log/syslog_ – системный лог-файл;
  - _/var/log/lightdm_ – лог-файл LightDM (для ОС РЕД ОС, ОС Альт);
  - _/var/log/sssd/_ – лог-файлы служб SSSD.
- _/etc/rtlogon/rtlogon.conf_ – конфигурационный файл rtlogon;
- _/etc/pki –_ корневые сертификаты;
- конфигурационные файлы компонентов ПО:
  - _/etc/X11/fly-dm/fly-dmrc/_ – настройка экранного менеджера fly-dm;
  - _/etc/pam.d/_ – конфигурационные файлы PAM;
  - _/etc/selinux/config_ – информация о конфигурации подсистемы SELinux;
  - _/etc/sssd/_ – конфигурационные файлы sssd;
  - _/etc/krb5\*_ – конфигурационные файлы Kerberos;
  - _/etc/control/_ – настройки подсистемы control – утилиты ОС Альт;
  - _/etc/samba/_ – настройка samba;
  - _/etc/lightdm/_ – настройка экранного менеджера LightDM;
  - _/etc/\*-release_ – информация о дистрибутиве ОС;
  - _/usr/share/p11-kit/modules/_ – информация о настройке модулей p11-kit;
  - _/usr/share/fly-wm/theme.master/themerc_ – параметры конфигурации оконного менеджера fly-wm;
  - _/usr/share/authselect/_ – конфигурация authselect;
  - _/usr/share/pam-configs/_ – конфигурация pam-auth-update;
  - _/usr/share/xsessions/_ – описание X11 графических оболочек.
- CRL-файлы.

## Приложение 1\. Ошибки

### Ошибки, выводимые в GUI

| Ошибка на английском языке | Ошибка на русском языке |
| --- | --- |
| Administrator PIN-code is blocked | PIN-код Администратора заблокирован |
| An unknown error has occurred | Произошла неизвестная ошибка |
| Auth object on token and in local config mismatch | Способ аутентификации в системе, указанный на токене и на ПК, не совпадают |
| Auth type on token and in local config mismatch | Тип аутентификации в системе, указанный на токене и на ПК, не совпадают |
| Authentication failed. Contact the Administrator | Вход в систему недоступен. Обратитесь к администратору.<br>Общая выводимая на экран ошибка для следующих ошибок в лог-файлах:<br>- на токене не найден закрытый ключ (no private key found on token);<br>- проверка ключевой пары не пройдена (challenge request didn't pass);<br>- на токене не найден сложный пароль (no strong password object found on token);<br>- не поддерживаемый тип ключа (unsupported key type);<br>- атрибут сертификата CKA\_LABEL пуст или содержит неверное значение (certificate's CKA\_LABEL attribute is empty or contains invalid characters);<br>- метка токена пуста или содержит неверное значение (token label is empty or contains invalid characters);<br>- ошибки pam\_sss (\[pam\_sss errors\]);<br>- неизвестная ошибка pam\_sss (an unknown pam sss error has occurred);<br>- на токене обнаружено несколько закрытых ключей с одинаковым CKA\_ID (multiple private keys with the same CKA\_ID found on token);<br>- на токене обнаружено несколько сложных паролей с одинаковым CKA\_ID (multiple strong password objects with the same CKA\_ID found on token);<br>- неизвестный пользователь (user is unknown);<br>- ошибкаинициализациипроверки EVP\_Digest (EVP\_DigestVerifyInit failed).<br>Также общая ошибка может возникать в следующих случаях:<br>- сертификат пользователя отозван;<br>- целостность данных CRL-файла нарушена;<br>- CRL-файл отсутствует по пути, указанному в настройках;<br>- срок действия CRL-файла истек, и параметр soft\_crl не включен в конфигурационный файл sssd.conf;<br>- возникли ошибки в цепочке доверия CRL-файла;<br>- сервер OCSP недоступен, и параметр soft\_ocsp не включен в конфигурационный файл sssd.conf |
| Authentication took longer than expected and was terminated. Please try again | Аутентификация заняла больше времени, чем ожидалось. Пожалуйста, повторите попытку |
| Authentication with a token is required to access this account | Войти в данную учетную запись можно только при помощи токена |
| Bad login policy provided | Указана неверная политика входа в систему |
| Can't set strong password for user in system | Не удалось установить сложный пароль для пользователя в системе |
| Can't unblock | Разблокировка для этой модели токена недоступна |
| Certificate is not yet valid | Сертификат ещё не вступил в действие |
| Connection failed, please try again | Установить соединение не удалось. Повторите попытку |
| Couldn't change PIN-code | Не удалось сменить PIN-код |
| Couldn't parse the account records on the token | Не удалось считать УЗ на токене |
| Couldn't parse the local account records on the PC | Не удалось считать локальные УЗ на ПК |
| Current user certificate has expired | Срок действия сертификата выбранного пользователя истек |
| Incorrect Administrator PIN-code | Неверный PIN-код Администратора |
| Incorrect Administrator PIN-code. Attempts left: | Неверный PIN-код Администратора. Осталось попыток: |
| Incorrect login or password | Неверный логин или пароль |
| Incorrect PIN-code | Неверный PIN-код |
| Incorrect PIN-code. Attempts left: ... | Неверный PIN-код. Осталось попыток: ... |
| Login policy provided with non-cert auth type | Невозможно войти в УЗ по сложному паролю при политике 'вход только по сертификату' |
| Multiple certificates with the same CKA\_ID found on token | На токене обнаружено несколько сертификатов с одинаковым CKA\_ID |
| Multiple copies of the same domain account record detected. Make sure there are no duplicate domain account records on connected tokens | Обнаруженонесколькокопий одной и тойже записи доменной УЗ.Убедитесь, что вподключенныхтокенахнетповторяющихся записей доменной УЗ |
| Mutually exclusive flags PAM\_PRELIM\_CHECK and PAM\_UPDATE\_AUTHTOK are set | Внутренняя ошибка PAM |
| Network manager isn't available | Утилита Network manager недоступна |
| New and old PIN-code are same | Новый и старый PIN-код совпадают |
| New PIN-code can't be empty | Поле для PIN-кода не заполнено |
| New PIN-code doesn't comply with PIN-code policy | Новый PIN-код не соответствует политике качества PIN-кодов |
| New PIN-code doesn't comply with PIN-code policy: PIN-code must contain at least ... characters | Новый PIN-код не соответствует политике качества PIN-кодов: PIN-код должен содержать не менее ... символов |
| New PIN-code has invalid length | Неверная длина нового PIN-кода |
| New PIN-code is default | Новый PIN-код совпадает с PIN-кодом по умолчанию |
| No accounts found on token | На токене не найдены УЗ |
| No certificate body found on token | Отсутствует сертификат на токене |
| No CKA\_ID attribute | Отсутствует атрибут CKA\_ID |
| No connected devices found | Нет подключенных устройств |
| No connections available | Нет доступных подключений |
| No matching certificate found on token | На токене не найден соответствующий сертификат |
| No PKCS libraries found. Authentication with a token isn't available | Нет библиотек PKCS. Аутентификация по токену недоступна |
| No PKCS libraries found. Connected devices won't be shown | Нет библиотек PKCS. Подключенные устройства не будут отображаться |
| No tokens found | Не найдены токены |
| Not logged in | Пользователь не авторизован |
| Operation took longer than expected and was terminated. Please try again | Операция заняла больше времени, чем ожидалось. Пожалуйста, повторите попытку |
| Parallel sessions not supported | Не поддерживается несколько сессий |
| Passwords don't match | Пароли не совпадают |
| Password field doesn't filled | Поле для пароля не заполнено |
| PIN-code can only be changed by the Administrator | PIN-код может изменить только администратор |
| PIN-code change has been aborted | Смена PIN-кода была прервана |
| PIN-code change took longer than expected and was terminated. Please try again | Смена PIN-кода заняла больше времени, чем ожидалось. Пожалуйста, повторите попытку |
| PIN-code field doesn't filled | Поле для PIN-кода не заполнено |
| PIN-code has not been unblocked | PIN-код не разблокирован |
| PIN-code is blocked | PIN-код заблокирован |
| PIN-code length must be between ... and ... characters | Длина PIN-кода должна находиться в пределах допустимого диапазона: от ... до ... включительно |
| PIN-code on token was corrupted | PIN-код токена поврежден |
| PIN-code too weak | PIN-код слишком простой |
| PIN-codes don't match | Введенные PIN-коды не совпадают |
| PublicAuthDesc object is ambiguous. There is more than one instance of this object on token | На токене найдено несколько УЗ |
| Strong password regeneration failed | Сложный пароль не перегенерирован |
| Strong password regeneration took longer than expected and was terminated. Please try again | Перегенерация сложного пароля заняла больше времени, чем ожидалось. Пожалуйста, повторите попытку |
| The domain user's password has expired. Change your password | Срок действия пароля доменного пользователя истек. Измените пароль |
| This PIN-code has already been used | Этот PIN-код уже использовался (PIN-код содержится в истории PIN-кодов) |
| Token device error | Внутренняя ошибка токена |
| Token general error | Ошибка токена |
| Token not present | Токен отсутствует |
| Token not recognized | Токен не распознан |
| Token removed | Токен удален с ПК |
| Too many sessions already open | Превышен лимит открытых сессий |
| Too many simultaneously logged users | Превышен лимит авторизованных пользователей |
| Unknown auth type | Неизвестный тип аутентификации |

### Ошибки, выводимые в терминале

| Ошибка | Описание ошибки |
| --- | --- |
| Account(s) with two-factor authentication was(were) found: | Былинайденыучетныезаписис настроенной 2ФА |
| An unknown error has occurred | Произошла неизвестная ошибка |
| Application couldn't be configured. Join PC to a domain first | Не удалось сконфигурировать rtlogon. Добавьте ПК в домен |
| Application has already been configured. To change the configuration, run the reconfigure command | ОС уже настроена для работы с 2ФА. Чтобы изменить настройки используйте команду `rtlogon-cli reconfigure` |
| Application hasn't been configured yet. Run the configure command first | ОС не была настроена для работы с 2ФА. Сначала выполните команду `rtlogon-cli configure` |
| Application isn't configured for domain operations | ОС не настроена для работы с доменной 2ФА |
| Application isn't configured for domain operations. Use the option --domain to specify the domain type | ОС не настроена для работы с доменной 2ФА. <br>Используйте параметр `--domain`, чтобы задать тип домена |
| Application parameters have not been changed. Application was not reconfigured | Параметры rtlogon не изменились. ОС не была реконфигурирована для работы с 2ФА |
| Archive extension is required | Необходимо указать расширение для архива |
| At least one of the ... or ... options should be specified | Должен быть указан один из обязательных параметров |
| Bad auth type provided: | Указан неверный тип аутентификации |
| CA certificates file corrupted. Try run: rtlogon-cli reconfigure | ФайлсертификатовУЦповрежден.Попробуйтевыполнить команду`rtlogon-cli reconfigure` |
| Cannot get authselect profile | Не удаетсяполучить профиль authselect |
| Cannot get passwd info | Не удаетсяполучитьинформацию о пароле доступа |
| Can't change password for domain user | Неудаетсяизменитьпарольдля доменного пользователя |
| Can't collect object information | Невозможно собрать информацию об объекте |
| Can't complete collection of token info | Неудаетсязавершитьсборинформации о токенах |
| Can't complete collection of OS info | Неудаетсязавершитьсборинформацииоб ОС |
| Can't complete collection of PKCS#11 libraries info | Неудаетсязавершитьсборинформации о библиотеках PKCS#11 |
| Can't configure password expiration | Неудаетсязадать срок истечения действия пароля |
| Can't convert DER to x509 structure | НеудаетсяпреобразоватьDERвструктуруx509 |
| Can't create hash | Неудается вычислить хеш |
| Can't create new cipher context | Неудаетсясоздатьновыйконтекстшифрования |
| Can't create temp dir to collect rtlogon logs | Неудаетсясоздатьвременнуюдиректориюдлясборалог-файлов rtlogon |
| Can't decrypt data | Неудаетсярасшифроватьданные |
| Can't determine domain name | Неудается определить имя домена при настройке аутентификации |
| Can't determine kdc hostname | Неудается определить имя КД при настройке аутентификации |
| Can't enable lightdm greeter | Неудается включить экран приветствия LightDM |
| Can't encrypt string | Неудаетсязашифроватьстроку |
| Can't find cipher | Неудаетсянайтишифр (код) |
| Can't find rtlogon configuration file. Try run: rtlogon-cli configure | Неудаетсянайти конфигурационный файл rtlogon. Попробуйте выполнить команду `rtlogon-cli configure` |
| Can't find p11\_child | Неудаетсянайтиp11\_child |
| Can't find pkinit plugin. Try to install 'krb5-pkinit' package | Неудаетсянайтиплагинpkinit.Попробуйтеустановитьпакет"krb5-pkinit" |
| Can't find record on token to auth user via smart-card | Не удается найти на токене запись для аутентификации пользователя по смарт-карте |
| Can't get decrypt result | Неудаетсяполучитьрезультат расшифрования |
| Can't get encrypt result | Неудаетсяполучитьрезультатшифрования |
| Can't get hash result | Неудается получить результат хеширования |
| Can't get info from inserted tokens | Неудаетсяполучитьинформациюотподключенныхтокенов |
| Can't get mem from BIO | Неудаетсяполучить сообщение из BIO |
| Can't get PEM from X509 | НеудаетсяполучитьPEM из X509 |
| Can't get PEM from X509\_REQ | НеудаетсяполучитьPEM из X509\_REQ |
| Can't get pubkey from EVP\_PKEY | Неудаетсяполучить открытый ключ из EVP\_PKEY |
| Can't get pubkey value | Неудаетсяполучитьзначение открытого ключа |
| Can't get rtengine | Неудается получить rtengine |
| Can't init decrypt context | Неудаетсяинициализироватьконтекст расшифрования |
| Can't init encrypt context | Неудаетсяинициализироватьконтекстшифрования |
| Can't init hash context | Неудаетсяинициализироватьхеш-контекст |
| Can't init openssl | Неудается инициализировать OpenSSL |
| Can't init rtengine | Неудается инициализировать rtengine |
| Can't load rtengine | Неудается загрузить rtengine |
| Can't open file to read: | Не удается открыть файл для чтения |
| Can't open file to write: | Не удается открыть файл для записи |
| Can't read certificate | Неудаетсяпрочитатьсертификат |
| Can't restart sssd: You have to restart it manually. Or just restart your PC | Неудаетсяперезапуститьsssd. Необходимоперезапуститьеговручную илиперезагрузитьПК |
| Can't retrieve env vars | Неудаетсяполучитьпеременныеenv |
| Can't use argument --passwd: authentication via strong password isn't available for root and users with access to sudo. Use authentication setup with arguments --cert and --login-policy certandpass | Невозможна аутентификация администратора по сложному паролю |
| Certificates must be in PEM format. Try run: rtlogon-cli reconfigure | Сертификаты должны быть в форматеPEM.Попробуйтевыполнить команду`rtlogon-cli reconfigure` |
| Сonfigurator failed with error: | Настройка не выполнена. Возникла ошибка: |
| Сonfigurator failed with unknown error | Настройка не выполнена. Возникла неизвестная ошибка |
| Could not find greeter plugin | Неудалосьнайтиплагин экрана приветствия |
| Could not find greeter theme | Неудалосьнайти тему экрана приветствия |
| Couldn't change password | Не удалось сменить пароль |
| Couldn't configure the system: missing configuration utilities. Supported pam configuration utilities: pam-auth-update, authselect, control | Не удалось настроитьсистему:отсутствуютутилитынастройки. Поддерживаемыеутилитынастройкиpam:pam-auth-update,authselect,control |
| Couldn't create an rtlogon profile in authselect | Не удалось создать профиль rtlogon в authselect |
| Couldn't determine Alt version | Не удалось определитьверсию ОС Альт |
| Couldn't determine default profile | Не удалось определитьпрофиль по умолчанию |
| Couldn't determine Redos version | Не удалось определитьверсию ОС РЕД ОС |
| Couldn't enable the rtlogon profile in pam-auth-update | Не удалось включитьпрофиль rtlogon вpam-auth-update |
| Couldn't find a password section with pam\_tcb or pam\_unix in pam configs | Не удалось найтиразделпаролейс помощью pam\_tcbилиpam\_unixвнастройкахpam |
| Couldn't find CA certificates in configuration files. Use the option --ca-cert to provide it manually | Не удалось найти в конфигурации rtlogon файл, содержащий корневой сертификат или сертификаты цепочки доверия УЦ.<br>Добавьте его вручную, используя параметр `--ca-cert arg` |
| Couldn't find the pam config with passwords | Не удалось найтиконфигурациюpamспаролями |
| Couldn't get domain administrator rights | Не удалось получитьправаадминистраторадомена |
| Couldn't get the current authselect profile. You might need to set it up first using the 'authselect select <profile>' command | Не удалось получить текущий профиль authselect. Возможно, вам необходимосперванастроитьего с помощьюкоманды `authselect select <profile>` |
| Couldn't get the current control system-auth profile | Не удалось получитьтекущийпрофиль контроля системы аутентфикации |
| Couldn't modify the rtlogon profile in authselect. Error in | Не удалось изменить профиль rtlogon в authselect. Ошибка в ... |
| Couldn't parse the account records on the token | Не удалось считать УЗ на токене |
| Couldn't parse the local account records on the PC: | Не удалось считать локальные УЗ на ПК |
| Couldn't parse the local account records on the PC. Try run rtlogon-cli reconfigure | Не удалось считать локальные учетные записи на ПК. Выполните команду `rtlogon-cli reconfigure` |
| Couldn't parse the rtlogon configuration file | Не удалось считать конфигурационный файл rtlogon |
| Couldn't read the specified CA certificates | Не удалось прочитать сертификат коревого УЦ или цепочки доверия УЦ |
| Couldn't remove the rtlogon profile from pam-auth-update | Не удалось удалитьпрофиль rtlogon изpam-auth-update |
| Couldn't restore the old authselect profile: | Не удалось восстановить старый профиль authselect: |
| Couldn't restore the old control system-auth profile | Не удалось восстановитьстарыйпрофиль контроля системы аутентификации |
| Couldn't revoke domain administrator rights | Не удалось отозватьправаадминистраторадомена |
| Couldn't select the rtlogon profile in authselect | Не удалось выбрать профиль rtlogon в authselect |
| Couldn't setup the control system-auth profile | Не удалось настроить профиль контроля системы аутентификации |
| error readPem | Ошибка чтения pem-файла |
| Failed while setting certificate duration | Произошел сбойприустановкесрока действия сертификата |
| Failed to create archive via tar | Неудалосьсоздать tar-архив |
| Failed to create archive via zip | Неудалосьсоздать zip-архив |
| Failed to generate a key pair | Не удалось сгенерировать ключевую пару |
| Failed to get Samba Workgroup | Неудалосьполучитьрабочую группу Samba |
| Failed to open file: | Неудалось открыть файл: |
| Failed to read file: | Неудалось считать файл: |
| Failed while assigning BIGNUM | Не удалось назначить BIGNUM |
| Failed while getting BIGNUM | Не удалосьполучить BIGNUM |
| Failed while getting RSA size | Не удалосьполучить размер ключа RSA |
| Failed while setting DN values | Не удалосьзадать значения DN |
| Failed while setting pubkey | Не удалосьзадать открытый ключ |
| Failed while signing certificate | Не удалось подписатьсертификат |
| File not found at specified path: | Файлненайденпоуказанномупути: |
| Found conflicting options: ... and ... | Конфликт параметров: ... и ... |
| Incorrect domain type | Неверный тип домена |
| Incorrect file provided: ... is a certificate request. Please provide a valid certificate | Указан неверный файл. ... – запрос на сертификат. Укажите действительный сертификат |
| Incorrect PIN-code | Неверный PIN-код |
| Incorrect PIN-code. Attempts left: ... | Неверный PIN-код. Осталось попыток: ... |
| INI file parse error: | Ошибка анализа файла INI: |
| Invalid --alg argument: | Неверный аргумент у параметра `--alg`: |
| Invalid --disconnect-policy argument: | Неверный аргумент у параметра `--disconnect-policy:` |
| Invalid --dn argument: | Неверный аргумент у параметра `--dn`: |
| Invalid --login-policy argument: | Неверный аргумент у параметра `--login-policy` |
| Invalid path to CA certificates | Неверный путь к файлу сертификата УЦ (сертификатам цепочки доверия УЦ) |
| Invalid value of ... param: ... | Неверное значение параметра: |
| Login policy \\"certonly\\" isn't available for root and users with access to sudo. Use authentication setup with argument --login-policy certandpass | Невозможна аутентификация администратора только по сертификату |
| More than one token inserted. Option --token-id should be specified. Select one of these token IDs: | К ПК подключено несколько токенов. Необходимо задать значение параметру `--token-id` |
| Multiple certificates with the same CKA\_ID found on token | На токене обнаружено несколько сертификатов с одинаковым CKA\_ID |
| New PIN-code doesn't comply with PIN-code policy | Новый PIN-код не соответствует политике качества PIN-кодов |
| New PIN-code doesn't comply with PIN-code policy: PIN-code must contain at least ... characters | Новый PIN-код не соответствует политике качества PIN-кодов: PIN-код должен содержать не менее ... символов |
| New PIN-code has invalid length | Неверная длина нового PIN-кода |
| No filename was provided for option --output | Не указан файл для параметра `--output` |
| No 'lightdm' package found. Try configure with the flag --use-system-gui | Не настроен пользовательский экран приветствия.<br>Пакет"lightdm"ненайден.Попробуйтенастроить экран приветствия с помощью параметра`--use-system-gui` |
| No login policy provided | Не предоставлены политики входа |
| No matching certificate found on token | На токене не найден соответствующий сертификат |
| No tokens found | Не найдены токены |
| Not enough memory on token to complete this operation | На токене недостаточно памяти для выполнения этой операции |
| Not found (valid library must be version no lower than). | Библиотека не найдена |
| Operation was canceled | Отключение настроек ОС для работы 2ФА было прервано.<br>Администратор не подтвердил продолжение выполнения команды `rtlogon-cli unconfigure` |
| Option ... can only be set for local users with authentication via a strong password | Параметр ... может быть задан только для локального пользователя с настроенной 2ФА по сложному паролю |
| Option --dn ... should be specified | При вызове команды `rtlogon-cli create-cert` не был указан параметр `dn` |
| Option --output should be specified | Должен быть указан параметр `--output` |
| Option ... should be specified | Пропущен обязательный параметр |
| PIN-code can only be changed by the Administrator | PIN-код может изменить только администратор |
| PIN-codes don't match | Введенные PIN-коды не совпадают |
| PIN-code length must be between ... and ... characters | Длина PIN-кода должна находиться в пределах допустимого диапазона: от ... до ... включительно |
| PIN-code not initialized | PIN-код не инициализирован |
| PIN-code too weak | PIN-код слишком простой |
| read error | Ошибка чтения |
| Record for user: "..." already exists | Записьдляпользователяужесуществует |
| Record not found for user: | Не найдена запись пользователя |
| Record on token not found for user: | На токене не найдена запись о пользователе: |
| run as root | Запуск от имени root (администратора) |
| Shell command failed | Не выполнена команда оболочки |
| Shell command failed with error:... | Команда оболочки завершилась ошибкой:... |
| The --days option can only be set with the --self-signed option | Параметр--daysможетбытьустановлентолькос совместно с параметром--self-signed |
| The license validation failed with error: ... | Проверкалицензиизавершиласьошибкой: ... |
| The operation can't be executed. Fix the rtlogon configuration file | Операция не можетбытьвыполнена.Исправьтеконфигурационныйфайл rtlogon |
| The option can only be set for records with the 'cert' auth type | Параметрможетбытьустановлентолько для 2ФА по сертификату |
| The required argument CN for option --dn is missing | При вызове команды `rtlogon-cli create-cert` не был указан аргумент параметра `dn -- CN` |
| The required argument for option ... is missing | Не указан аргумент у параметра... |
| This PIN-code has already been used | Этот PIN-код уже использовался (PIN-код содержится в истории PIN-кодов) |
| Token doesn't support gost256 | Токен не поддерживает криптоалгоритм ГОСТ с длиной ключа 256 байт |
| Token doesn't support gost512 | Токен не поддерживает криптоалгоритм ГОСТ с длиной ключа 512 байт |
| Token doesn't support RSA | Токен не поддерживает криптоалгоритм RSA |
| Token is write protected | Токен недоступен для записи |
| Token with provided token ID was not found | Токен с заданным идентификатором не найден |
| Too many failed attempts in a row | Слишком много неудачных попыток подряд |
| Unable to change owner of: | Неудается сменить владельца |
| Unable to convert Subject to DER | Неудается конвертировать субъект в формат DER |
| Unable to convert the specified certificate | Неудаетсяконвертироватьуказанныйсертификат |
| Unable to convert x509 object to DER | Неудается конвертировать объект x509 в формат DER |
| Unable to get length of asn1 object | Неудаетсяполучитьдлинуобъектаasn1 |
| Unable to get length of Subject | Неудаетсяполучитьдлину субъекта |
| Unable to get length of x509 object | Неудаетсяполучитьдлину объекта x509 |
| Unable to stringify asn1 object | Неудаетсяструктурироватьобъектasn1 |
| Unknown control system-auth profile: ... | Неизвестный профиль контроля системы аутентификации |
| Unknown domain type | Неизвестный тип домена |
| Unknown option(s) | Неизвестный параметр(ы) |
| Unknown user type (domain or local) for: | Неизвестный тип пользователя (доменный или локальный) |
| Unsupported archive extension. Check if the appropriate compression utilities are installed. Supported extensions: ... | Неподдерживаемый тип архива |
| Unsupported command | Неподдерживаемая команда |
| Unsupported operating system: | Неподдерживаемая ОС Astra Linux |
| User not found on host | Пользователь не найден на ПК |
| Value for argument --days must be between 1 and 5500, inclusive | Время действия сертификата должно быть в диапазоне от 1 до 5500 дней включительно |
| Wrong expire value | Неверноезначениесрока действия |
| X509\_cmp\_current\_time | Текущее время X509\_cmp |
| X509\_cmp\_current\_time failed | Неверное текущее время X509\_cmp |
| You can't run lock screen using sudo | Вы не можетезапуститьэкранблокировки с помощьюsudo |

- No labels